{"id":"Clavain-00s","title":"Add upstream-sync PR codex refresh reminder workflow","status":"closed","priority":2,"issue_type":"task","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-08T15:04:52.36967936-08:00","created_by":"mk","updated_at":"2026-02-08T15:05:17.498383499-08:00","closed_at":"2026-02-08T15:05:17.498383499-08:00","close_reason":"Closed"}
{"id":"Clavain-089","title":"Move fd-code-quality and fd-user-experience to Adaptive Reviewers","description":"Merge Domain Specialists into Adaptive Reviewers with dual-mode behavior (codebase-aware when docs exist, generic fallback otherwise). Change model from sonnet to inherit. Update SKILL.md roster, scoring rules, and all references to Domain Specialists category.","status":"closed","priority":2,"issue_type":"task","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-09T12:02:22.360524401-08:00","created_by":"mk","updated_at":"2026-02-09T12:05:10.955152546-08:00","closed_at":"2026-02-09T12:05:10.955152546-08:00","close_reason":"Merged Domain Specialists into Adaptive Reviewers with dual-mode behavior"}
{"id":"Clavain-08w","title":"Fix /triage broken markdown (code fence leak)","description":"commands/triage.md Final Summary section has improperly nested code fences around line 196-310. Four-backtick fence opens but subsequent content appears outside with its own triple-backtick fences. Source: flux-drive P2-7.","status":"closed","priority":2,"issue_type":"bug","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-08T22:21:09.205846904-08:00","created_by":"mk","updated_at":"2026-02-08T23:08:16.775527394-08:00","closed_at":"2026-02-08T23:08:16.775527394-08:00","close_reason":"Closed"}
{"id":"Clavain-09c","title":"P1: resolve-* commands share 80% identical structure — consolidate","status":"closed","priority":1,"issue_type":"task","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-08T00:23:37.668039371-08:00","created_by":"mk","updated_at":"2026-02-08T04:21:04.137287805-08:00","closed_at":"2026-02-08T04:21:04.137287805-08:00","close_reason":"Closed"}
{"id":"Clavain-0je","title":"Remove --yolo and --dangerously-bypass-approvals-and-sandbox from dispatch.sh passthrough","description":"dispatch.sh:143 whitelists dangerous Codex flags for passthrough. A prompt injection could disable safety guardrails. Either remove from whitelist or require CLAVAIN_ALLOW_UNSAFE=1 env var. Source: flux-drive SEC-3 (MEDIUM).","status":"closed","priority":1,"issue_type":"bug","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-08T22:20:03.603945906-08:00","created_by":"mk","updated_at":"2026-02-09T00:14:36.647715614-08:00","closed_at":"2026-02-09T00:14:36.647715614-08:00","close_reason":"--yolo and --dangerously-bypass-approvals-and-sandbox blocked by default in dispatch.sh. CLAVAIN_ALLOW_UNSAFE=1 override added."}
{"id":"Clavain-0xm","title":"Merge agent-sdk-dev into Clavain","description":"Pull /new-sdk-app command + agent-sdk-verifier-py + agent-sdk-verifier-ts from the official agent-sdk-dev plugin. Scaffolds standalone Agent SDK apps (Python/TS) with best practices verification. Highest-impact merge — fills the biggest gap.","status":"closed","priority":1,"issue_type":"feature","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-08T01:03:02.420407787-08:00","created_by":"mk","updated_at":"2026-02-08T01:06:36.282268798-08:00","closed_at":"2026-02-08T01:06:36.282268798-08:00","close_reason":"Wrong framing — Clavain is a modpack, not a monolith. Replacing with modpack-oriented issues."}
{"id":"Clavain-16r","title":"Add scripts/validate-roster.sh to check roster-to-file correspondence","design":"docs/plans/plan-clavain-16r.md","status":"closed","priority":3,"issue_type":"task","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-09T14:57:51.826803415-08:00","created_by":"mk","updated_at":"2026-02-10T08:44:52.400519935-08:00","closed_at":"2026-02-10T08:44:52.400519935-08:00","close_reason":"Closed","dependencies":[{"issue_id":"Clavain-16r","depends_on_id":"Clavain-th4","type":"blocks","created_at":"2026-02-09T15:10:44.734914558-08:00","created_by":"mk"}]}
{"id":"Clavain-1by","title":"Validation scripts only check 1 of 3 hooks","description":"CLAUDE.md quick commands section only validates session-start.sh with bash -n. Should also validate agent-mail-register.sh and dotfiles-sync.sh.","status":"closed","priority":4,"issue_type":"bug","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-08T00:25:17.497198614-08:00","created_by":"mk","updated_at":"2026-02-08T08:38:40.35274001-08:00","closed_at":"2026-02-08T08:38:40.35274001-08:00","close_reason":"Already fixed — CLAUDE.md lines 19-21 check all 3 hooks"}
{"id":"Clavain-1li","title":"Create CI workflow for test suite","description":"Create .github/workflows/test.yml with two jobs: (1) structural-and-shell: runs Tier 1+2 on every push and PR, ubuntu-latest, no secrets needed, ~30-45s. (2) smoke: runs Tier 3 on daily cron + workflow_dispatch + path-filtered push (hooks/agents/skills/.claude-plugin changes only), needs ANTHROPIC_API_KEY, 30min timeout, skip condition for forks. Per plan: docs/plans/2026-02-10-test-suite-design.md Step 5.","status":"closed","priority":2,"issue_type":"task","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-10T12:18:15.565819265-08:00","created_by":"mk","updated_at":"2026-02-10T13:00:31.533980179-08:00","closed_at":"2026-02-10T13:00:31.533980179-08:00","close_reason":"Created .github/workflows/test.yml with structural+shell (every push) and smoke (schedule/manual) jobs, plus tests/run-tests.sh local runner","dependencies":[{"issue_id":"Clavain-1li","depends_on_id":"Clavain-j25","type":"blocks","created_at":"2026-02-10T12:18:21.013721864-08:00","created_by":"mk"},{"issue_id":"Clavain-1li","depends_on_id":"Clavain-g1w","type":"blocks","created_at":"2026-02-10T12:18:21.069531266-08:00","created_by":"mk"}]}
{"id":"Clavain-1rl","title":"codex-delegation missing from routing table Layer 2","description":"The using-clavain/SKILL.md routing table Layer 2 (Execution) doesn't mention codex-delegation or codex-first-dispatch skills.","status":"closed","priority":4,"issue_type":"bug","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-08T00:25:24.952681166-08:00","created_by":"mk","updated_at":"2026-02-08T09:00:55.070195686-08:00","closed_at":"2026-02-08T09:00:55.070195686-08:00","close_reason":"Closed"}
{"id":"Clavain-1va","title":"Remove manual token trimming from launch.md — trust 200K context windows","design":"docs/plans/plan-clavain-1va.md","status":"closed","priority":2,"issue_type":"task","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-09T14:57:50.942824288-08:00","created_by":"mk","updated_at":"2026-02-10T08:27:52.271546763-08:00","closed_at":"2026-02-10T08:27:52.271546763-08:00","close_reason":"Closed"}
{"id":"Clavain-1x6","title":"Add sync workflow preflight for required API secrets","status":"closed","priority":2,"issue_type":"task","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-08T15:32:36.946667552-08:00","created_by":"mk","updated_at":"2026-02-08T15:33:50.281351592-08:00","closed_at":"2026-02-08T15:33:50.281351592-08:00","close_reason":"Closed"}
{"id":"Clavain-1yg","title":"Expand upstream file mappings for beads/oracle/agent-mail","status":"closed","priority":1,"issue_type":"feature","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-08T17:04:12.651789793-08:00","created_by":"mk","updated_at":"2026-02-08T17:08:20.112299161-08:00","closed_at":"2026-02-08T17:08:20.112299161-08:00","close_reason":"Closed"}
{"id":"Clavain-21l","title":"Update validate-roster.sh for 6 agents","description":"Update the roster validation script to check 6 v2 agents instead of 19 v1 agents in the Plugin Agents table.","status":"closed","priority":2,"issue_type":"task","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-10T09:42:23.636017366-08:00","created_by":"mk","updated_at":"2026-02-10T09:59:17.698707206-08:00","closed_at":"2026-02-10T09:59:17.698707206-08:00","close_reason":"Phase 3 complete — all Codex agents succeeded","dependencies":[{"issue_id":"Clavain-21l","depends_on_id":"Clavain-oxr","type":"blocks","created_at":"2026-02-10T09:42:28.759465082-08:00","created_by":"mk"}]}
{"id":"Clavain-246","title":"Modernize spec-flow-analyzer system prompt style","description":"spec-flow-analyzer still opens with 'You are an elite User Experience Flow Analyst and Requirements Engineer.' The consolidated agents dropped the superlative pattern in favor of straightforward role statements. Low priority cosmetic alignment.","status":"closed","priority":4,"issue_type":"task","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-09T11:42:25.691203665-08:00","created_by":"mk","updated_at":"2026-02-09T11:56:42.576337986-08:00","closed_at":"2026-02-09T11:56:42.576337986-08:00","close_reason":"Codex agents completed all 3 tasks successfully"}
{"id":"Clavain-27u","title":"Replace YAML frontmatter with rigid markdown Findings Index + central findings.json","description":"From 3-model debate consensus (Oracle's approach). Replace YAML frontmatter requirement with:\n\n1. Agents output a rigid markdown pattern:\n   ### Findings Index\n   - P0 | P0-1 | \"Section\" | Title\n   - P1 | P1-1 | \"Section\" | Title\n   Then standard prose: Summary, Issues Found, Improvements Suggested, Overall Assessment\n   Last line: Verdict: safe|needs-changes|risky\n\n2. Orchestrator generates {OUTPUT_DIR}/findings.json centrally after synthesis (Phase 3)\n3. Remove Step 3.1 YAML validation — no longer needed\n4. Remove malformed/fallback classification\n5. Update prompt template in launch.md to use new format\n6. Update review-agent.md Codex template to match\n\nKey insight: centralize structured output at the orchestrator, don't distribute schema compliance across stochastic writers.\n\nFiles: skills/flux-drive/phases/launch.md (prompt template), skills/flux-drive/phases/synthesize.md (remove 3.1, add findings.json generation), skills/clodex/templates/review-agent.md","design":"docs/plans/plan-clavain-27u.md","status":"closed","priority":2,"issue_type":"feature","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-09T14:57:39.861097112-08:00","created_by":"mk","updated_at":"2026-02-10T08:44:52.383493317-08:00","closed_at":"2026-02-10T08:44:52.383493317-08:00","close_reason":"Closed","dependencies":[{"issue_id":"Clavain-27u","depends_on_id":"Clavain-7p2","type":"blocks","created_at":"2026-02-09T18:15:32.918628113-08:00","created_by":"mk"}]}
{"id":"Clavain-2e4","title":"Delete clodex-toggle.md (redundant alias for codex-first)","description":"clodex-toggle.md is 16 lines that say 'follow codex-first'. Both appear in routing table and Quick Reference. Delete the file, update routing table and Quick Reference. Source: flux-drive P2-1 (3 agents agree).","status":"closed","priority":2,"issue_type":"task","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-08T22:20:10.743257921-08:00","created_by":"mk","updated_at":"2026-02-08T23:11:18.252400002-08:00","closed_at":"2026-02-08T23:11:18.252400002-08:00","close_reason":"Deleted clodex-toggle.md, removed from routing tables, updated command counts 27→26 in CLAUDE.md, README.md, AGENTS.md, plugin.json"}
{"id":"Clavain-2em","title":"P0: agent-native-audit uses invalid skill invocation syntax","description":"- type: bug","status":"closed","priority":0,"issue_type":"bug","created_at":"2026-02-07T13:42:34.467206667-08:00","updated_at":"2026-02-07T20:13:25.91305097-08:00","closed_at":"2026-02-07T20:13:25.91305097-08:00","close_reason":"Closed","labels":["flux-drive"]}
{"id":"Clavain-2kf","title":"Default to summary.md for file inputs, opt-in for inline annotations","design":"docs/plans/plan-clavain-2kf.md","status":"closed","priority":1,"issue_type":"task","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-09T14:57:42.533841422-08:00","created_by":"mk","updated_at":"2026-02-10T08:27:52.244503043-08:00","closed_at":"2026-02-10T08:27:52.244503043-08:00","close_reason":"Closed"}
{"id":"Clavain-2kt","title":"escape_for_json duplicated in 2 hooks","description":"Both session-start.sh and agent-mail-register.sh define their own escape_for_json function. Consider extracting to shared hooks/lib.sh.","status":"closed","priority":4,"issue_type":"bug","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-08T00:25:20.190188641-08:00","created_by":"mk","updated_at":"2026-02-08T09:00:55.113120516-08:00","closed_at":"2026-02-08T09:00:55.113120516-08:00","close_reason":"Closed"}
{"id":"Clavain-2nx","title":"P1: writing-skills overweight (656 lines) — extract TDD tutorial","status":"closed","priority":1,"issue_type":"task","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-08T00:23:30.312248067-08:00","created_by":"mk","updated_at":"2026-02-08T04:21:04.175592314-08:00","closed_at":"2026-02-08T04:21:04.175592314-08:00","close_reason":"Closed"}
{"id":"Clavain-2ry","title":"learnings-researcher model: haiku undocumented","description":"agents/research/learnings-researcher.md uses model: haiku instead of inherit. This is the only agent with a non-inherit model. The rationale is sound but undocumented.","status":"closed","priority":4,"issue_type":"bug","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-08T00:25:23.489907171-08:00","created_by":"mk","updated_at":"2026-02-08T09:00:55.081773587-08:00","closed_at":"2026-02-08T09:00:55.081773587-08:00","close_reason":"Closed"}
{"id":"Clavain-2yx","title":"Strip \u003cexample\u003e blocks from agent prompts during flux-drive dispatch","description":"During flux-drive launch (Phase 2), the orchestrator should strip \u003cexample\u003e/\u003ccommentary\u003e blocks from agent .md file content before including it in the task prompt. These blocks exist for triage routing (helping the orchestrator decide relevance) but serve no purpose inside the agent's own execution context. Saves ~500-1500 chars per agent × N agents = 1-3K tokens per run. Implementation: in the prompt construction step of launch.md, add an instruction for the orchestrator to strip \u003cexample\u003e...\u003c/example\u003e blocks from agent system prompts before pasting them into task prompts. Only affects Project Agents (whose .md content is pasted manually) — Adaptive Reviewers load system prompts natively via subagent_type. Files: skills/flux-drive/phases/launch.md, skills/flux-drive/phases/launch-codex.md","design":"docs/plans/plan-clavain-2yx.md","status":"closed","priority":1,"issue_type":"task","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-09T18:14:37.579859962-08:00","created_by":"mk","updated_at":"2026-02-10T08:27:52.254017468-08:00","closed_at":"2026-02-10T08:27:52.254017468-08:00","close_reason":"Closed"}
{"id":"Clavain-3gb","title":"allowed-tools format varies across commands","description":"Some commands use array format for allowed-tools, others use different formatting. Standardize across all 24 commands.","status":"closed","priority":4,"issue_type":"bug","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-08T00:25:22.282836255-08:00","created_by":"mk","updated_at":"2026-02-08T09:00:55.104002378-08:00","closed_at":"2026-02-08T09:00:55.104002378-08:00","close_reason":"Closed"}
{"id":"Clavain-3ke","title":"P1: Normalize skill descriptions to \"Use when\" pattern","description":"- type: task","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-07T13:42:34.478526417-08:00","updated_at":"2026-02-07T23:52:45.849996002-08:00","closed_at":"2026-02-07T23:52:45.849996002-08:00","close_reason":"Closed","labels":["flux-drive"]}
{"id":"Clavain-3r1","title":"P0: Stale component counts across docs","description":"- type: bug","status":"closed","priority":0,"issue_type":"bug","created_at":"2026-02-07T13:42:34.462016488-08:00","updated_at":"2026-02-07T20:10:43.758954506-08:00","closed_at":"2026-02-07T20:10:43.758954506-08:00","close_reason":"Closed","labels":["flux-drive"]}
{"id":"Clavain-3se","title":"Fix review agent count across 5 documentation surfaces (20/15 → 21)","description":"AGENTS.md:40, AGENTS.md:275, README.md:234, README.md:259, docs/plugin-audit.md:21 all show stale review agent counts. Actual is 21. Fix: 5 line edits. Source: flux-drive P0-1 (3 agents agree).","status":"closed","priority":0,"issue_type":"bug","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-08T22:19:06.450909721-08:00","created_by":"mk","updated_at":"2026-02-08T23:07:54.166997555-08:00","closed_at":"2026-02-08T23:07:54.166997555-08:00","close_reason":"Closed"}
{"id":"Clavain-3t4","title":"P1: review.md overweight (455 lines) + stale .claude/skills/ paths","status":"closed","priority":1,"issue_type":"bug","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-08T00:23:30.41936068-08:00","created_by":"mk","updated_at":"2026-02-08T04:21:04.157402732-08:00","closed_at":"2026-02-08T04:21:04.157402732-08:00","close_reason":"Closed"}
{"id":"Clavain-460","title":"P1: engineering-docs XML tags contradict create-agent-skills guidance","description":"- type: bug","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-02-07T13:42:34.475021591-08:00","updated_at":"2026-02-07T23:52:45.854167295-08:00","closed_at":"2026-02-07T23:52:45.854167295-08:00","close_reason":"Closed","labels":["flux-drive"]}
{"id":"Clavain-4pj","title":"Create mcp-server-design skill from agent-mail docs","description":"Thin skill that references agent-mail's GUIDE_TO_OPTIMAL_MCP_SERVER_DESIGN.md as canonical MCP server design reference. Uses context7/WebFetch to pull docs at runtime. Fills the 'build an MCP server from scratch' gap without duplicating content.","status":"closed","priority":1,"issue_type":"feature","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-08T01:03:02.414739656-08:00","created_by":"mk","updated_at":"2026-02-08T01:06:36.267998547-08:00","closed_at":"2026-02-08T01:06:36.267998547-08:00","close_reason":"Wrong framing — Clavain is a modpack, not a monolith. Replacing with modpack-oriented issues."}
{"id":"Clavain-4q1","title":"Move spec-flow-analyzer to own sub-table or rename Adaptive Reviewers table","status":"closed","priority":3,"issue_type":"bug","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-09T14:57:49.025969227-08:00","created_by":"mk","updated_at":"2026-02-09T15:18:44.260259605-08:00","closed_at":"2026-02-09T15:18:44.260259605-08:00","close_reason":"Consolidated into Clavain-th4"}
{"id":"Clavain-4u9","title":"flux-drive: Add YAML frontmatter validation (Phase 3)","status":"closed","priority":2,"issue_type":"task","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-08T14:29:18.986660919-08:00","created_by":"mk","updated_at":"2026-02-08T14:32:03.019423197-08:00","closed_at":"2026-02-08T14:32:03.019423197-08:00","close_reason":"Added Step 3.0.5 with valid/malformed/missing classification and user-facing validation report"}
{"id":"Clavain-4us","title":"Agent Mail integration — auto-register and coordinate","description":"Clavain already has agent-mail-register.sh hook and agent-mail-coordination skill, but they're disconnected. Wire them: auto-register on session start (done), auto-reserve files when starting work on beads issues, auto-release on close, inject coordination context when multiple agents detected. The agent-mail MCP server in plugin.json should be conditional on the server running.","status":"closed","priority":1,"issue_type":"feature","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-08T01:07:51.229147212-08:00","created_by":"mk","updated_at":"2026-02-08T04:21:04.194820272-08:00","closed_at":"2026-02-08T04:21:04.194820272-08:00","close_reason":"Closed"}
{"id":"Clavain-4z1","title":"Pre-filter triage table to domain-relevant agents only","description":"The triage step (Phase 1, Step 1.2) currently scores all 19+ agents in the roster against the document profile. For a Python CLI tool, the orchestrator still scores go-reviewer, rust-reviewer, typescript-reviewer, shell-reviewer, data-migration-expert, deployment-verification-agent etc. — all of which will be 0. This wastes ~800 tokens of orchestrator context on zero-score rows. Fix: add a pre-filter step that eliminates obviously irrelevant agents before scoring. Use the document profile's Languages and Domains fields to skip agents whose domain has zero overlap. Only present the scoring table for agents that could plausibly score ≥1. Expected savings: ~300-500 tokens per run (minor, but free). Files: skills/flux-drive/SKILL.md (Step 1.2 scoring rules)","design":"docs/plans/plan-clavain-4z1.md","status":"closed","priority":2,"issue_type":"task","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-09T18:14:56.358024965-08:00","created_by":"mk","updated_at":"2026-02-10T08:27:52.285690801-08:00","closed_at":"2026-02-10T08:27:52.285690801-08:00","close_reason":"Closed"}
{"id":"Clavain-54o","title":"Add Codex dispatch path to flux-drive Phase 2","description":"Restructure Phase 2: Step 2.1 detect mode, Step 2.2 Task dispatch (existing), Step 2.3 Codex dispatch with path guards, mktemp, error handling, cleanup","status":"closed","priority":1,"issue_type":"task","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-08T16:08:15.839919681-08:00","created_by":"mk","updated_at":"2026-02-08T16:35:31.912126551-08:00","closed_at":"2026-02-08T16:35:31.912126551-08:00","close_reason":"Phase 2 restructured by Codex: Steps 2.0-2.3, Tier 2 bootstrap, error handling, cleanup","dependencies":[{"issue_id":"Clavain-54o","depends_on_id":"Clavain-fmu","type":"blocks","created_at":"2026-02-08T16:08:24.769383698-08:00","created_by":"mk"}]}
{"id":"Clavain-563","title":"Add timeout to foreground retry in Step 2.3 (5 min cap)","status":"closed","priority":0,"issue_type":"task","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-09T14:57:39.06090112-08:00","created_by":"mk","updated_at":"2026-02-09T15:16:12.12253345-08:00","closed_at":"2026-02-09T15:16:12.12253345-08:00","close_reason":"Consolidated into Clavain-nta"}
{"id":"Clavain-578","title":"/work: delegate reviewer guidance to /quality-gates","description":"/work Phase 3 includes optional reviewer agents and example Task invocations that overlap heavily with /quality-gates. Remove reviewer-selection details from /work and replace with: 'If change is risky/large → run /quality-gates' and 'If user asks for external second opinion → run /interpeer quick'. Keep /work focused on execution discipline. Source: Oracle interpeer deep review Finding 3.","status":"closed","priority":3,"issue_type":"feature","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-09T07:08:17.729572612-08:00","created_by":"mk","updated_at":"2026-02-09T07:17:37.140262561-08:00","closed_at":"2026-02-09T07:17:37.140262561-08:00","close_reason":"Closed"}
{"id":"Clavain-5kd","title":"P1: JSON injection in agent-mail-register.sh heredoc","status":"closed","priority":1,"issue_type":"bug","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-08T00:23:30.106863374-08:00","created_by":"mk","updated_at":"2026-02-08T04:21:04.012562497-08:00","closed_at":"2026-02-08T04:21:04.012562497-08:00","close_reason":"Closed"}
{"id":"Clavain-5o2","title":"P1: Differentiate or merge work vs execute-plan commands","description":"- type: task","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-07T13:42:34.480886313-08:00","updated_at":"2026-02-07T23:53:45.673424373-08:00","closed_at":"2026-02-07T23:53:45.673424373-08:00","close_reason":"Closed","labels":["flux-drive"]}
{"id":"Clavain-5pl","title":"P1: AGENTS.md references nonexistent scripts/sync-upstreams.sh","status":"closed","priority":1,"issue_type":"bug","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-08T00:23:37.557683725-08:00","created_by":"mk","updated_at":"2026-02-08T04:21:04.039144881-08:00","closed_at":"2026-02-08T04:21:04.039144881-08:00","close_reason":"Closed"}
{"id":"Clavain-64o","title":"Smoke test GitHub PR command workflows and upstream review queue","status":"closed","priority":2,"issue_type":"task","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-08T15:26:05.979066251-08:00","created_by":"mk","updated_at":"2026-02-08T15:28:15.91803306-08:00","closed_at":"2026-02-08T15:28:15.91803306-08:00","close_reason":"Closed"}
{"id":"Clavain-690","title":"Surface per-agent completion ticks during 3-5 min wait","design":"docs/plans/plan-clavain-690.md","status":"closed","priority":1,"issue_type":"task","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-09T14:57:37.107904093-08:00","created_by":"mk","updated_at":"2026-02-10T08:27:52.301736531-08:00","closed_at":"2026-02-10T08:27:52.301736531-08:00","close_reason":"Closed","dependencies":[{"issue_id":"Clavain-690","depends_on_id":"Clavain-8xs","type":"blocks","created_at":"2026-02-09T15:10:44.524417435-08:00","created_by":"mk"},{"issue_id":"Clavain-690","depends_on_id":"Clavain-nta","type":"blocks","created_at":"2026-02-09T15:16:12.043838669-08:00","created_by":"mk"}]}
{"id":"Clavain-6a4","title":"Slim agent system prompts for flux-drive context","description":"Review agents have system prompts ranging from 3K to 13K chars. When invoked by flux-drive, several sections are redundant: 1. The agent's native Output Format section is overridden by flux-drive's prompt template. 2. Personality/style instructions (e.g., concurrency-reviewer's 'British wit and Eastern-European directness') don't affect finding quality in structured output mode. 3. Verbose language-specific pattern libraries (concurrency-reviewer has 152 lines) could be condensed. Options: a) Add \u003c!-- flux-drive: skip --\u003e markers in agent .md files that the prompt constructor strips. b) Create separate flux-drive-optimized prompt variants (maintenance burden). c) Accept the cost — agent richness may occasionally produce better findings. Estimated savings: ~2-5K tokens per run across all agents. Files: agents/review/*.md, skills/flux-drive/phases/launch.md","design":"docs/plans/plan-clavain-6a4.md","status":"closed","priority":2,"issue_type":"task","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-09T18:15:15.715267417-08:00","created_by":"mk","updated_at":"2026-02-10T08:27:52.262403304-08:00","closed_at":"2026-02-10T08:27:52.262403304-08:00","close_reason":"Closed"}
{"id":"Clavain-6f7","title":"Fix setup.md phantom /clavain:tool-time reference","description":"commands/setup.md:144 references /clavain:tool-time but tool-time is a separate plugin (tool-time:tool-time). Remove the clavain: prefix or replace with correct namespace. Source: flux-drive P2-18.","status":"closed","priority":2,"issue_type":"bug","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-08T22:20:03.751126662-08:00","created_by":"mk","updated_at":"2026-02-08T23:07:54.196340339-08:00","closed_at":"2026-02-08T23:07:54.196340339-08:00","close_reason":"Closed"}
{"id":"Clavain-6fi","title":"Create agent-deployment skill","description":"Deployment patterns for agent apps: Docker, Fly.io, Railway, AWS Lambda, Cloudflare. References agent-mail's deployment_samples/ (cloudflare-pages-example.toml, github-actions-share.yml). Thin shim, not templates.","status":"closed","priority":2,"issue_type":"feature","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-08T01:03:02.41725278-08:00","created_by":"mk","updated_at":"2026-02-08T01:06:36.286592647-08:00","closed_at":"2026-02-08T01:06:36.286592647-08:00","close_reason":"Wrong framing — Clavain is a modpack, not a monolith. Replacing with modpack-oriented issues."}
{"id":"Clavain-6ue","title":"P1: Dual upstream sync systems undocumented","description":"- type: task","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-07T13:42:34.473610828-08:00","updated_at":"2026-02-07T23:53:45.662109483-08:00","closed_at":"2026-02-07T23:53:45.662109483-08:00","close_reason":"Closed","labels":["flux-drive"]}
{"id":"Clavain-6vp","title":"P1: Broad Bash tool access in sync.yml — narrow to read-only git ops","status":"closed","priority":1,"issue_type":"bug","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-08T00:23:30.165696721-08:00","created_by":"mk","updated_at":"2026-02-08T04:21:04.022922175-08:00","closed_at":"2026-02-08T04:21:04.022922175-08:00","close_reason":"Closed"}
{"id":"Clavain-6xd","title":"Update AGENTS.md scripts/ tree and .github/workflows/ tree to match disk","description":"AGENTS.md:53-54 shows only upstream-check.sh in scripts/ but dispatch.sh, debate.sh, install-codex.sh, upstream-impact-report.py also exist. Workflows tree shows 4 of 8. README shows 2 of 8. Source: flux-drive P1-2, P1-3.","status":"closed","priority":1,"issue_type":"bug","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-08T22:20:17.189846272-08:00","created_by":"mk","updated_at":"2026-02-08T23:07:54.232306069-08:00","closed_at":"2026-02-08T23:07:54.232306069-08:00","close_reason":"Closed"}
{"id":"Clavain-72c","title":"Add setup, compound, interpeer to routing tables","description":"3 commands appear only in Quick Reference, not in the 3-layer routing tables. setup→Meta, compound→Ship, interpeer→Review. Source: flux-drive P1-7 (3 agents agree).","status":"closed","priority":2,"issue_type":"task","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-08T22:20:28.932211197-08:00","created_by":"mk","updated_at":"2026-02-09T00:36:31.373712288-08:00","closed_at":"2026-02-09T00:36:31.373712288-08:00","close_reason":"Added setup→Meta, compound→Ship, interpeer→Review in Layer 1 routing tables."}
{"id":"Clavain-733","title":"Add \u003cexample\u003e blocks to 5 fd-* agents","description":"fd-architecture, fd-code-quality, fd-performance, fd-security, fd-user-experience lack the \u003cexample\u003e+\u003ccommentary\u003e blocks required by AGENTS.md convention. All other 24 agents have them. Source: flux-drive P1-5 (2 agents agree).","status":"closed","priority":2,"issue_type":"task","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-08T22:20:26.662630819-08:00","created_by":"mk","updated_at":"2026-02-09T00:36:31.433171509-08:00","closed_at":"2026-02-09T00:36:31.433171509-08:00","close_reason":"Added \u003cexample\u003e blocks to all 5 fd-* agents. YAML validated."}
{"id":"Clavain-752","title":"flux-drive: Validate Phase 4 Oracle escalation code paths","status":"closed","priority":2,"issue_type":"task","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-08T14:29:23.539400249-08:00","created_by":"mk","updated_at":"2026-02-08T14:30:01.217577593-08:00","closed_at":"2026-02-08T14:30:01.217577593-08:00","close_reason":"Added fallback Oracle detection, timeout+error handling for Oracle CLI, and splinterpeer availability check"}
{"id":"Clavain-75h","title":"P1: work.md and review.md contain branch/worktree refs violating trunk policy","status":"closed","priority":1,"issue_type":"bug","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-08T00:23:37.833281175-08:00","created_by":"mk","updated_at":"2026-02-08T04:21:04.093324682-08:00","closed_at":"2026-02-08T04:21:04.093324682-08:00","close_reason":"Closed"}
{"id":"Clavain-75u","title":"P0: Hook count mismatch — docs say '2 hooks' but 3 scripts across 2 events","status":"closed","priority":0,"issue_type":"bug","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-08T00:23:24.89656063-08:00","created_by":"mk","updated_at":"2026-02-08T00:36:15.168011479-08:00","closed_at":"2026-02-08T00:36:15.168011479-08:00","close_reason":"Closed"}
{"id":"Clavain-7e2","title":"flux-drive: Fix stale integration claims + add qmd (Integration)","status":"closed","priority":2,"issue_type":"task","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-08T14:29:21.636065165-08:00","created_by":"mk","updated_at":"2026-02-08T14:30:25.150898186-08:00","closed_at":"2026-02-08T14:30:25.150898186-08:00","close_reason":"Removed stale writing-plans/brainstorming claims, added qmd to Step 1.0 and See Also"}
{"id":"Clavain-7l4","title":"P0: AGENTS.md falsely claims 'only SessionStart hook' — SessionEnd exists","status":"closed","priority":0,"issue_type":"bug","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-08T00:23:24.958180674-08:00","created_by":"mk","updated_at":"2026-02-08T00:36:15.172916825-08:00","closed_at":"2026-02-08T00:36:15.172916825-08:00","close_reason":"Closed"}
{"id":"Clavain-7nk","title":"Create 6 core v2 agent files","description":"Create agents/review/fd-v2-{architecture,safety,correctness,quality,user-product,performance}.md by merging 19 specialized agents into 6 core agents per the v2 architecture doc.","status":"closed","priority":1,"issue_type":"task","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-10T09:42:17.422218124-08:00","created_by":"mk","updated_at":"2026-02-10T09:54:04.030682144-08:00","closed_at":"2026-02-10T09:54:04.030682144-08:00","close_reason":"Closed"}
{"id":"Clavain-7ns","title":"Modpack manifest — define Clavain's required/recommended plugin list","description":"Clavain should declare which plugins it expects to be installed and how they integrate. Create a modpack manifest (e.g. modpack.json or section in AGENTS.md) listing: required plugins (context7, agent-mail, beads hooks), recommended plugins (agent-sdk-dev, interclode, interpeer, gurgeh-plugin), and optional plugins (serena, supabase, vercel). Include version constraints and conflict detection (e.g. hookify OFF because Clavain manages hooks directly).","status":"closed","priority":0,"issue_type":"feature","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-08T01:07:51.235145988-08:00","created_by":"mk","updated_at":"2026-02-08T01:16:26.090641271-08:00","closed_at":"2026-02-08T01:16:26.090641271-08:00","close_reason":"Modpack manifest added to AGENTS.md — required/recommended/infrastructure/conditional/conflicts sections.","dependencies":[{"issue_id":"Clavain-7ns","depends_on_id":"Clavain-82g","type":"blocks","created_at":"2026-02-08T01:09:56.803222431-08:00","created_by":"mk"}]}
{"id":"Clavain-7p2","title":"Resolve output format strategy: native YAML vs markdown Findings Index","description":"Two competing approaches to the output format problem exist: 1. Clavain-27u proposes replacing YAML frontmatter with rigid markdown Findings Index + central findings.json (from 3-model debate consensus). 2. The flux-drive architecture evaluation (docs/research or brain artifact) recommends the opposite: make YAML frontmatter the native format in all review agent .md files, eliminating the 50-line Output Format Override block from the prompt template. Both solve the same problem (the override conflict between agent native format and flux-drive format), but in different directions. Clavain-27u centralizes structured output at the orchestrator. Native YAML pushes it to agents. Decision needed: which approach better suits the overall system? Consider: token cost (native YAML saves ~2K/run in override instructions), agent reusability (agents used outside flux-drive need their own format), maintenance (one format vs two). This bead should be resolved before implementing either Clavain-27u or the native YAML approach.","design":"docs/plans/plan-clavain-7p2.md","status":"closed","priority":1,"issue_type":"task","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-09T18:15:29.536815425-08:00","created_by":"mk","updated_at":"2026-02-10T08:21:15.591016328-08:00","closed_at":"2026-02-10T08:21:15.591016328-08:00","close_reason":"Decision: Option C (Hybrid). Agents keep native prose format. Flux-drive prepends YAML frontmatter via a slimmed override (~15 lines instead of ~50). Agents work standalone AND in flux-drive. No agent file changes needed. Unblocks Clavain-27u which should be updated to implement the hybrid approach."}
{"id":"Clavain-7t5","title":"Add run_in_background: true to /review command agent dispatch","description":"commands/review.md launches 6+ agents in Phase 2 but never specifies run_in_background: true. flux-drive and quality-gates both require it. Without it, agent output floods the main conversation context. Source: flux-drive P1-14.","status":"closed","priority":1,"issue_type":"bug","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-08T22:20:13.615228319-08:00","created_by":"mk","updated_at":"2026-02-08T23:07:54.213963903-08:00","closed_at":"2026-02-08T23:07:54.213963903-08:00","close_reason":"Closed"}
{"id":"Clavain-80p","title":"Interpeer + Oracle integration — cross-AI review routing","description":"Clavain has oracle-review skill and interpeer is installed, but routing is manual. Add to flux-drive and /review: when Oracle available, automatically include GPT-5.2 perspective alongside Clavain's agent roster. Detect Oracle availability (DISPLAY=:99, chrome wrapper) at session start.","status":"closed","priority":2,"issue_type":"feature","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-08T01:07:51.24412959-08:00","created_by":"mk","updated_at":"2026-02-08T08:33:45.662245521-08:00","closed_at":"2026-02-08T08:33:45.662245521-08:00","close_reason":"Closed"}
{"id":"Clavain-82g","title":"Plugin audit — disable redundant plugins, document rationale","description":"Audit all 32 enabled plugins against Clavain's capabilities. Disable ~6 redundant official plugins (code-review, code-simplifier, commit-commands, feature-dev, claude-md-management, frontend-design). Evaluate tldrs, tldr-swinton, tuivision, explanatory-output-style for removal. Document keep/disable rationale in modpack manifest. This should be done as part of or before Clavain-7ns (modpack manifest).","status":"closed","priority":0,"issue_type":"task","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-08T01:09:51.750029448-08:00","created_by":"mk","updated_at":"2026-02-08T01:14:37.229321978-08:00","closed_at":"2026-02-08T01:14:37.229321978-08:00","close_reason":"Audit complete. 8 redundant plugins disabled, explanatory-output-style kept per user preference. See docs/plugin-audit.md."}
{"id":"Clavain-8xs","title":"Add universal completion protocol: atomic rename + run scoping","status":"closed","priority":0,"issue_type":"task","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-09T14:57:30.65982298-08:00","created_by":"mk","updated_at":"2026-02-09T15:16:12.146945011-08:00","closed_at":"2026-02-09T15:16:12.146945011-08:00","close_reason":"Consolidated into Clavain-nta"}
{"id":"Clavain-95h","title":"P1: Rails content in general-purpose agents","description":"- type: bug","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-02-07T13:42:34.470600675-08:00","updated_at":"2026-02-07T23:52:45.843566266-08:00","closed_at":"2026-02-07T23:52:45.843566266-08:00","close_reason":"Closed","labels":["flux-drive"]}
{"id":"Clavain-99t","title":"Fix README flux-drive roster claim (28 agents → actual 19 fixed)","description":"README.md:58 says flux-drive pulls from a roster of 28 agents across 4 tiers but the fixed roster is 19 (5 T1 + 13 T3 + 1 T4). Tier 2 is dynamic. Rewrite to accurately describe tiered selection. Source: flux-drive P1-4.","status":"closed","priority":1,"issue_type":"bug","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-08T22:20:20.287238072-08:00","created_by":"mk","updated_at":"2026-02-08T23:07:54.223442044-08:00","closed_at":"2026-02-08T23:07:54.223442044-08:00","close_reason":"Closed"}
{"id":"Clavain-9tq","title":"Fast-follow deferred flux-drive v2 features (8 items)","description":"Deferred doc: docs/research/flux-drive-v2-deferred.md. Eight independently shippable features cut from v2 MVP, each with trigger conditions: (1) Two-tier knowledge — trigger: 20+ reviews, \u003e30% single-project entries. (2) Ad-hoc agent generation — trigger: roster gaps. Note: Oracle flagged prompt injection risk for in-repo agent storage. (3) Async deep-pass — trigger: 50+ reviews. (4) Agent graduation pipeline — depends on two-tier. (5) Complex frontmatter — trigger: qmd precision issues. (6) Dynamic agent cap — trigger: cost data. (7) 7th agent Reliability/Deploy — trigger: ops review gaps (Oracle recommendation). (8) Claim-level convergence — trigger: low-resolution convergence at 6 agents (Oracle recommendation).","status":"open","priority":3,"issue_type":"feature","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-10T08:52:06.455144174-08:00","created_by":"mk","updated_at":"2026-02-10T08:52:06.455144174-08:00","dependencies":[{"issue_id":"Clavain-9tq","depends_on_id":"Clavain-urz","type":"blocks","created_at":"2026-02-10T08:52:11.679956241-08:00","created_by":"mk"}]}
{"id":"Clavain-9xj","title":"Downgrade sync.yml Codex sandbox from danger-full-access to workspace-write","description":"sync.yml:84 runs Codex with --sandbox danger-full-access granting unrestricted filesystem+network. Auth.json is readable. Clone upstreams in a separate shell step, then run Codex with workspace-write. Source: flux-drive SEC-2 (HIGH).","status":"closed","priority":1,"issue_type":"bug","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-08T22:20:03.413055107-08:00","created_by":"mk","updated_at":"2026-02-09T00:14:36.724685676-08:00","closed_at":"2026-02-09T00:14:36.724685676-08:00","close_reason":"sync.yml now clones upstreams in separate step, Codex runs with workspace-write instead of danger-full-access."}
{"id":"Clavain-9yc","title":"Create Tier 2 bootstrap template and staleness check","description":"New template at skills/clodex/templates/create-review-agent.md. Add sha256sum staleness check and blocking bootstrap dispatch to flux-drive Phase 2","status":"closed","priority":2,"issue_type":"task","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-08T16:08:17.707681901-08:00","created_by":"mk","updated_at":"2026-02-08T16:30:26.988165983-08:00","closed_at":"2026-02-08T16:30:26.988165983-08:00","close_reason":"create-review-agent.md bootstrap template created by Codex, verified","dependencies":[{"issue_id":"Clavain-9yc","depends_on_id":"Clavain-54o","type":"blocks","created_at":"2026-02-08T16:08:24.824759674-08:00","created_by":"mk"}]}
{"id":"Clavain-a3o","title":"Add upstream impact reporting and decision gate","notes":"Implementing upstream-impact workflow, decision-gate workflow, decision template, and runbook/AGENTS updates for human intervention on meaningful upstream changes.","status":"closed","priority":1,"issue_type":"feature","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-08T16:56:18.545532024-08:00","created_by":"mk","updated_at":"2026-02-08T17:02:10.006289849-08:00","closed_at":"2026-02-08T17:02:10.006289849-08:00","close_reason":"Completed: added upstream impact workflow, decision gate, decision record template, and documented intervention flow"}
{"id":"Clavain-a5v","title":"Switch GitHub workflows to Codex auth-json (no API key)","status":"closed","priority":2,"issue_type":"task","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-08T15:44:35.431675199-08:00","created_by":"mk","updated_at":"2026-02-08T15:44:39.716715619-08:00","closed_at":"2026-02-08T15:44:39.716715619-08:00","close_reason":"Closed"}
{"id":"Clavain-aab","title":"Complete README disabled-conflicts table (add 3 missing plugins)","description":"README.md:232-238 lists only 5 of 8 disabled plugins. Missing: claude-md-management, frontend-design, hookify. These are correctly listed in AGENTS.md and using-clavain. Fix: add 3 rows. Source: flux-drive P0-3.","status":"closed","priority":0,"issue_type":"bug","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-08T22:19:08.731615874-08:00","created_by":"mk","updated_at":"2026-02-08T23:07:54.187228287-08:00","closed_at":"2026-02-08T23:07:54.187228287-08:00","close_reason":"Closed"}
{"id":"Clavain-add","title":"Skills with approval gates: use AskUserQuestion tool","description":"Skills with user-approval gates should use the AskUserQuestion tool for structured interaction instead of inline text. Fixed: interpeer deep mode, flux-drive Step 1.3, clodex Step 1, landing-a-change Step 4. Verify no other skills need this pattern. Source: smoke test during interpeer deep review.","status":"closed","priority":3,"issue_type":"feature","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-09T07:08:34.072248989-08:00","created_by":"mk","updated_at":"2026-02-09T07:08:42.904166656-08:00","closed_at":"2026-02-09T07:08:42.904166656-08:00","close_reason":"Fixed in this session: interpeer deep, flux-drive Step 1.3, clodex Step 1, landing-a-change Step 4 all now use AskUserQuestion tool for approval gates."}
{"id":"Clavain-amz","title":"Template Step 3.5 synthesis report with same rigor as agent prompt template","design":"docs/plans/plan-clavain-amz.md","status":"closed","priority":1,"issue_type":"task","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-09T14:57:39.574966458-08:00","created_by":"mk","updated_at":"2026-02-10T08:51:43.507051458-08:00","closed_at":"2026-02-10T08:51:43.507051458-08:00","close_reason":"Closed","dependencies":[{"issue_id":"Clavain-amz","depends_on_id":"Clavain-27u","type":"blocks","created_at":"2026-02-09T15:10:44.387040448-08:00","created_by":"mk"}]}
{"id":"Clavain-apn","title":"Refactor launch-codex.md: extract shared contracts, keep only Codex-specific mechanics","description":"From debate consensus (Codex + Oracle agreed: keep but refactor as adapter). Extract shared contracts, keep Codex-specific mechanics only.\n\nDepends on Clavain-27u (Findings Index) because shared output format must be defined first.\n\nAcceptance criteria:\n1. Extract shared spec file (output format, completion signal, retry logic) referenced by both launch.md and launch-codex.md\n2. Shrink launch-codex.md to Codex-only: bootstrap, sandbox flags, dispatch invocation\n3. Fix the fallback: make it an orchestrator decision, not a bash variable (Oracle's insight — current CLODEX_MODE=false in bash doesn't update orchestrator control flow)\n4. Move shared prompt contract to shared spec\n\nFiles: skills/flux-drive/phases/launch.md, skills/flux-drive/phases/launch-codex.md, new shared spec file","design":"docs/plans/plan-clavain-apn.md","status":"closed","priority":2,"issue_type":"task","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-09T14:57:45.382945633-08:00","created_by":"mk","updated_at":"2026-02-10T08:51:43.518328218-08:00","closed_at":"2026-02-10T08:51:43.518328218-08:00","close_reason":"Closed","dependencies":[{"issue_id":"Clavain-apn","depends_on_id":"Clavain-27u","type":"blocks","created_at":"2026-02-09T15:22:04.924220629-08:00","created_by":"mk"}]}
{"id":"Clavain-ast","title":"SessionStart hook: auto-detect and configure companion plugins","description":"Extend session-start.sh to detect installed companion plugins and inject integration context. E.g.: if interclode installed, inject codex-first dispatch path; if beads .beads/ dir exists, inject bd prime context; if agent-mail running, inject coordination patterns. Currently each tool is siloed — the hook should wire them together.","status":"closed","priority":0,"issue_type":"feature","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-08T01:07:51.227764384-08:00","created_by":"mk","updated_at":"2026-02-08T01:16:26.136988554-08:00","closed_at":"2026-02-08T01:16:26.136988554-08:00","close_reason":"SessionStart hook now auto-detects interclode, beads, agent-mail, gurgeh, oracle and injects companion context."}
{"id":"Clavain-azd","title":"P1: engineering-docs overweight (489 lines) — extract to sub-files","status":"closed","priority":1,"issue_type":"task","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-08T00:23:30.26725497-08:00","created_by":"mk","updated_at":"2026-02-08T04:21:04.165878563-08:00","closed_at":"2026-02-08T04:21:04.165878563-08:00","close_reason":"Closed"}
{"id":"Clavain-b6n","title":"Modpack installer command — /clavain:setup","description":"Create a /setup command that: 1) installs required companion plugins from marketplace, 2) disables conflicting official plugins, 3) configures settings.json hooks for beads/dotfiles, 4) verifies MCP servers (agent-mail, context7), 5) runs initial bd init if beads not configured. One command to go from fresh Claude Code install to fully configured rig.","status":"closed","priority":2,"issue_type":"feature","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-08T01:07:51.229804786-08:00","created_by":"mk","updated_at":"2026-02-08T08:33:45.667208371-08:00","closed_at":"2026-02-08T08:33:45.667208371-08:00","close_reason":"Closed"}
{"id":"Clavain-b8o","title":"P1: flux-drive hardcodes gurgeh-plugin with no fallback","status":"closed","priority":1,"issue_type":"bug","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-08T00:23:37.713870155-08:00","created_by":"mk","updated_at":"2026-02-08T04:21:04.114105586-08:00","closed_at":"2026-02-08T04:21:04.114105586-08:00","close_reason":"Closed"}
{"id":"Clavain-b9j","title":"Interclode integration — codex-first as native mode","description":"Codex-first mode currently requires manual /clodex toggle and dispatch.sh path resolution. Make it native: detect interclode plugin path at session start, cache dispatch.sh location, expose codex-first toggle in modpack config, auto-dispatch for suitable tasks when mode is on. Currently scattered across 3 skills (codex-first, codex-first-dispatch, codex-delegation) — unify the entry point.","status":"closed","priority":1,"issue_type":"feature","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-08T01:07:51.241763136-08:00","created_by":"mk","updated_at":"2026-02-08T04:21:04.203569717-08:00","closed_at":"2026-02-08T04:21:04.203569717-08:00","close_reason":"Closed"}
{"id":"Clavain-ba3","title":"P1: Fix typos in resolve commands","description":"- type: bug","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-02-07T13:42:34.479704231-08:00","updated_at":"2026-02-07T22:44:29.837583924-08:00","closed_at":"2026-02-07T22:44:29.837583924-08:00","close_reason":"Closed","labels":["flux-drive"]}
{"id":"Clavain-ba6","title":"P1: engineering-docs has 3 duplicate heading pairs from XML conversion","status":"closed","priority":1,"issue_type":"bug","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-08T00:23:30.221669717-08:00","created_by":"mk","updated_at":"2026-02-08T04:21:04.082582553-08:00","closed_at":"2026-02-08T04:21:04.082582553-08:00","close_reason":"Closed"}
{"id":"Clavain-c2d","title":"Add codex-refresh automation and runbook pointers","status":"closed","priority":2,"issue_type":"task","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-08T15:00:03.911557914-08:00","created_by":"mk","updated_at":"2026-02-08T15:01:12.183994398-08:00","closed_at":"2026-02-08T15:01:12.183994398-08:00","close_reason":"Closed"}
{"id":"Clavain-c3f","title":"P0: Upstream sync prompt injection — no CODEOWNERS or branch protection","status":"closed","priority":0,"issue_type":"bug","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-08T00:23:25.08665328-08:00","created_by":"mk","updated_at":"2026-02-08T00:36:15.181687237-08:00","closed_at":"2026-02-08T00:36:15.181687237-08:00","close_reason":"Closed"}
{"id":"Clavain-c6m","title":"Add 1-sentence description to interpeer quick mode suggestion in Step 4.1","status":"closed","priority":4,"issue_type":"task","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-09T14:57:59.581398382-08:00","created_by":"mk","updated_at":"2026-02-09T15:16:50.290023905-08:00","closed_at":"2026-02-09T15:16:50.290023905-08:00","close_reason":"Absorbed into Clavain-ne6 as acceptance criteria","dependencies":[{"issue_id":"Clavain-c6m","depends_on_id":"Clavain-ne6","type":"blocks","created_at":"2026-02-09T15:10:44.588451869-08:00","created_by":"mk"}]}
{"id":"Clavain-c7i","title":"Replace auto-chain to interpeer mine mode with explicit user consent","status":"closed","priority":1,"issue_type":"task","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-09T14:57:45.729304381-08:00","created_by":"mk","updated_at":"2026-02-09T15:16:50.270482131-08:00","closed_at":"2026-02-09T15:16:50.270482131-08:00","close_reason":"Absorbed into Clavain-ne6 as acceptance criteria","dependencies":[{"issue_id":"Clavain-c7i","depends_on_id":"Clavain-ne6","type":"blocks","created_at":"2026-02-09T15:10:44.452153589-08:00","created_by":"mk"}]}
{"id":"Clavain-cna","title":"Fix flux-drive output format contract — agents don't produce YAML frontmatter","description":"Agent .md files define their own output formats (### UX Assessment, ### Architecture Assessment, etc.) which conflict with flux-drive's YAML frontmatter requirement in phases/launch.md:110-129. System prompt (agent def) typically wins over user prompt (task content), so agents produce their native format, not the frontmatter Phase 3 needs for machine-parseable synthesis. Fix: either add frontmatter to each agent's .md or add a flux-drive mode preamble that overrides native format.","status":"closed","priority":0,"issue_type":"bug","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-09T08:37:53.827602775-08:00","created_by":"mk","updated_at":"2026-02-09T08:50:03.19666029-08:00","closed_at":"2026-02-09T08:50:03.19666029-08:00","close_reason":"Closed"}
{"id":"Clavain-cqk","title":"Plugin conflict resolver — detect overlapping skills/agents","description":"Clavain overlaps with several official plugins: code-review (Clavain has review agents), commit-commands (Clavain has /commit via landing-a-change), code-simplifier (Clavain has code-simplicity-reviewer), feature-dev (Clavain has /work + /lfg). Create a conflict map and either: disable overlapping official plugins via settings, or create routing rules that prefer Clavain's opinionated versions.","status":"closed","priority":1,"issue_type":"feature","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-08T01:07:51.227998675-08:00","created_by":"mk","updated_at":"2026-02-08T04:21:04.213612228-08:00","closed_at":"2026-02-08T04:21:04.213612228-08:00","close_reason":"Closed"}
{"id":"Clavain-cy3","title":"Update clodex 'When NOT to Use' and add See Also","description":"Update clodex SKILL.md to distinguish dispatch infrastructure from review-as-task. Add See Also reference in flux-drive SKILL.md","status":"closed","priority":3,"issue_type":"task","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-08T16:08:19.215454557-08:00","created_by":"mk","updated_at":"2026-02-08T16:30:23.110199356-08:00","closed_at":"2026-02-08T16:30:23.110199356-08:00","close_reason":"clodex SKILL.md 'When NOT to Use' updated by Codex, verified"}
{"id":"Clavain-d39","title":"Create beads-deep-dive skill for advanced features","description":"Extends beads-workflow with advanced features: federation, daemon, multi-repo agents, messaging. Thin shim pointing to steveyegge/beads docs (MULTI_REPO_AGENTS.md, DAEMON.md, FEDERATION-SETUP.md, messaging.md) via context7/WebFetch. beads-workflow stays as quick-reference.","status":"closed","priority":2,"issue_type":"feature","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-08T01:03:02.42157694-08:00","created_by":"mk","updated_at":"2026-02-08T01:06:36.275017355-08:00","closed_at":"2026-02-08T01:06:36.275017355-08:00","close_reason":"Wrong framing — Clavain is a modpack, not a monolith. Replacing with modpack-oriented issues."}
{"id":"Clavain-d6f","title":"Extend upstream sync merge set to beads/oracle/agent-mail","notes":"Adding beads/oracle/mcp_agent_mail to upstreams.json fileMap and sync workflow docs/prompts so /clavain:upstream-sync can produce PRs for those repos too.","status":"closed","priority":1,"issue_type":"task","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-08T16:26:02.402102043-08:00","created_by":"mk","updated_at":"2026-02-08T16:33:44.779443325-08:00","closed_at":"2026-02-08T16:33:44.779443325-08:00","close_reason":"Completed: added beads/oracle/agent-mail to upstream merge automation and verified PR creation"}
{"id":"Clavain-dh6","title":"Remove thin-section deepening from synthesize.md (lines 79-109)","status":"closed","priority":2,"issue_type":"task","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-09T14:57:48.446134159-08:00","created_by":"mk","updated_at":"2026-02-09T20:29:23.260019298-08:00","closed_at":"2026-02-09T20:29:23.260019298-08:00","close_reason":"Removed thin-section deepening block (lines 79-109) from synthesize.md. Clean excision, zero downstream dependencies, file now 93 lines."}
{"id":"Clavain-dk5","title":"dotfiles-sync.sh hardcodes absolute path","description":"hooks/dotfiles-sync.sh hardcodes an absolute path that assumes a specific server layout. Should derive paths relative to the plugin directory.","status":"closed","priority":4,"issue_type":"bug","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-08T00:25:26.430275214-08:00","created_by":"mk","updated_at":"2026-02-08T09:00:55.05883342-08:00","closed_at":"2026-02-08T09:00:55.05883342-08:00","close_reason":"Closed"}
{"id":"Clavain-dng","title":"Improve Codex integration parity with Claude Code","status":"closed","priority":2,"issue_type":"feature","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-08T14:50:35.030468979-08:00","created_by":"mk","updated_at":"2026-02-08T14:56:01.937205394-08:00","closed_at":"2026-02-08T14:56:01.937205394-08:00","close_reason":"Closed"}
{"id":"Clavain-dt3","title":"P1: sync.yml requests unnecessary id-token:write permission","description":"- type: bug","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-02-07T13:42:34.477670262-08:00","updated_at":"2026-02-07T22:44:29.833043545-08:00","closed_at":"2026-02-07T22:44:29.833043545-08:00","close_reason":"Closed","labels":["flux-drive"]}
{"id":"Clavain-dxp","title":"Reconcile flux-drive tier naming — Tier 1 (sonnet) vs Tier 3 (opus) is misleading","description":"Tier 1 agents (fd-user-experience, fd-code-quality) use model: sonnet. Tier 3 adaptive agents (architecture-strategist etc.) use model: inherit (opus). In codebase-aware mode, Tier 3 is strictly more capable than Tier 1, making the numbering misleading. Also, synthesis prefers Tier 1/2 over Tier 3, which is wrong when Tier 3 is adaptive and codebase-aware. Consider renaming to Domain Specialists / Adaptive Reviewers / Language Reviewers.","status":"closed","priority":2,"issue_type":"task","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-09T08:38:01.738107073-08:00","created_by":"mk","updated_at":"2026-02-09T08:51:56.750202282-08:00","closed_at":"2026-02-09T08:51:56.750202282-08:00","close_reason":"Closed"}
{"id":"Clavain-dzb","title":"Add PR comment commands to trigger Claude/Codex review agents","status":"closed","priority":2,"issue_type":"feature","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-08T15:06:42.840415514-08:00","created_by":"mk","updated_at":"2026-02-08T15:08:16.202652381-08:00","closed_at":"2026-02-08T15:08:16.202652381-08:00","close_reason":"Closed"}
{"id":"Clavain-e3v","title":"argument-hint quoting inconsistency in 2 commands","description":"heal-skill.md and create-agent-skill.md use unquoted [bracket] format for argument-hint while 19 other commands use quoted format. Add quotes for consistency.","status":"closed","priority":4,"issue_type":"bug","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-08T00:25:12.415416801-08:00","created_by":"mk","updated_at":"2026-02-08T09:00:55.133552991-08:00","closed_at":"2026-02-08T09:00:55.133552991-08:00","close_reason":"Closed"}
{"id":"Clavain-e93","title":"Add /lfg error recovery guidance","description":"The 7-step /lfg pipeline has no failure handling. If any step fails, there is no stop-on-failure instruction, no retry guidance, and no resume-from-step-N capability. Add an Error Recovery section. Source: flux-drive P1-11.","status":"closed","priority":2,"issue_type":"feature","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-08T22:20:31.897127932-08:00","created_by":"mk","updated_at":"2026-02-09T00:14:36.828180214-08:00","closed_at":"2026-02-09T00:14:36.828180214-08:00","close_reason":"Error Recovery section added to lfg.md after Step 7."}
{"id":"Clavain-emx","title":"flux-drive Phase 4: replace stale splinterpeer/winterpeer with interpeer modes","description":"flux-drive embeds its own Oracle/cross-model escalation path (Tier 4 oracle-council + Phase 4 comparison + auto-chain) that still references splinterpeer and winterpeer. These are now merged into interpeer modes. Replace: splinterpeer chain → interpeer mine mode, winterpeer/council → interpeer council mode. Remove Tier 4 oracle-council or make it call interpeer deep/council. Source: Oracle interpeer deep review Finding 1.","status":"closed","priority":2,"issue_type":"bug","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-09T07:08:07.218005581-08:00","created_by":"mk","updated_at":"2026-02-09T07:16:41.4315094-08:00","closed_at":"2026-02-09T07:16:41.4315094-08:00","close_reason":"Closed"}
{"id":"Clavain-eqo","title":"P1: Red Flags table bloat — 16 lines of per-session context for marginal value","status":"closed","priority":1,"issue_type":"task","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-08T00:23:37.894343279-08:00","created_by":"mk","updated_at":"2026-02-08T04:21:04.104211024-08:00","closed_at":"2026-02-08T04:21:04.104211024-08:00","close_reason":"Closed"}
{"id":"Clavain-evw","title":"Add issue command to trigger upstream sync workflow","status":"closed","priority":2,"issue_type":"feature","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-08T15:53:43.104381214-08:00","created_by":"mk","updated_at":"2026-02-08T15:55:20.713493482-08:00","closed_at":"2026-02-08T15:55:20.713493482-08:00","close_reason":"Closed"}
{"id":"Clavain-f0m","title":"Add explicit Phase 4 skip condition in SKILL.md before file read","status":"closed","priority":4,"issue_type":"task","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-09T14:57:57.072250523-08:00","created_by":"mk","updated_at":"2026-02-09T15:16:50.311460862-08:00","closed_at":"2026-02-09T15:16:50.311460862-08:00","close_reason":"Absorbed into Clavain-ne6 as acceptance criteria","dependencies":[{"issue_id":"Clavain-f0m","depends_on_id":"Clavain-ne6","type":"blocks","created_at":"2026-02-09T15:10:44.662042048-08:00","created_by":"mk"}]}
{"id":"Clavain-fjr","title":"Beads integration — make bd the default task tracker","description":"Clavain should enforce beads as the task tracker when .beads/ exists. Currently the SessionStart hook from beads' own config handles this, but Clavain should own it: suppress TaskCreate/TodoWrite in favor of bd create, ensure bd prime runs on session start/compact, add bd sync to landing-a-change skill. Make beads a first-class citizen, not an afterthought.","status":"closed","priority":1,"issue_type":"feature","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-08T01:07:51.237292659-08:00","created_by":"mk","updated_at":"2026-02-08T04:21:04.186343861-08:00","closed_at":"2026-02-08T04:21:04.186343861-08:00","close_reason":"Closed"}
{"id":"Clavain-fmu","title":"Create review-agent.md template","description":"New template at skills/clodex/templates/review-agent.md with Explore/Analyze/Write phases and Final Report","status":"closed","priority":2,"issue_type":"task","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-08T16:08:13.565772025-08:00","created_by":"mk","updated_at":"2026-02-08T16:30:23.036731572-08:00","closed_at":"2026-02-08T16:30:23.036731572-08:00","close_reason":"review-agent.md template created by Codex, verified"}
{"id":"Clavain-g1w","title":"Implement Tier 2 shell tests (bats-core)","description":"Create tests/shell/ with bats-core tests for all hooks: session_start.bats, autopilot.bats, lib.bats, auto_compound.bats, agent_mail_register.bats, dotfiles_sync.bats, hooks_json.bats, plus test_helper.bash with shared setup. Needs fixture files in tests/fixtures/ (minimal_tool_input.json, transcript JSONL files, stop_hook_stdin.json). Per plan: docs/plans/2026-02-10-test-suite-design.md Steps 3-4.","status":"closed","priority":2,"issue_type":"task","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-10T12:18:07.939173861-08:00","created_by":"mk","updated_at":"2026-02-10T12:57:00.797734829-08:00","closed_at":"2026-02-10T12:57:00.797734829-08:00","close_reason":"31 bats tests passing across 7 test files with 5 fixtures","dependencies":[{"issue_id":"Clavain-g1w","depends_on_id":"Clavain-vpf","type":"blocks","created_at":"2026-02-10T12:18:20.956111262-08:00","created_by":"mk"}]}
{"id":"Clavain-g30","title":"Add \u003cexample\u003e blocks to fd-code-quality and fd-user-experience descriptions","description":"AGENTS.md convention requires all agent descriptions to include concrete \u003cexample\u003e blocks with \u003ccommentary\u003e. The 2 surviving fd-* Domain Specialists (fd-code-quality, fd-user-experience) lack these. All other agents (including the 3 new PRD agents and 3 consolidated agents) have proper examples. Add 1-2 examples each showing when flux-drive would select them.","status":"closed","priority":3,"issue_type":"task","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-09T11:42:23.996687773-08:00","created_by":"mk","updated_at":"2026-02-09T11:56:42.566973142-08:00","closed_at":"2026-02-09T11:56:42.566973142-08:00","close_reason":"Codex agents completed all 3 tasks successfully"}
{"id":"Clavain-gf0","title":"flux-drive: Add triage calibration examples (Phase 1)","status":"closed","priority":2,"issue_type":"task","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-08T14:29:22.443881458-08:00","created_by":"mk","updated_at":"2026-02-08T14:30:47.803275752-08:00","closed_at":"2026-02-08T14:30:47.803275752-08:00","close_reason":"Added scoring examples for Go API plan and Python CLI README, plus quantitative thin/adequate/deep thresholds"}
{"id":"Clavain-gvu","title":"Validation comparison: run flux-drive v2 on real document and compare vs v1","description":"Bead 7 from the flux-drive v2 plan. Run /clavain:flux-drive on a recent real document (e.g. a PR, spec, or code change) and compare v2 output against a v1 run on the same input. Check: (1) agent selection — do 6 agents cover what 19 did? (2) finding quality — are merged agents as thorough? (3) knowledge injection — does qmd retrieval add value? (4) compounding — do knowledge entries get created? (5) synthesis — is the final report coherent with fewer agents? This is the confidence gate before shipping v2 to users.","status":"closed","priority":1,"issue_type":"task","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-10T10:30:15.494455136-08:00","created_by":"mk","updated_at":"2026-02-10T13:12:31.670161278-08:00","closed_at":"2026-02-10T13:12:31.670161278-08:00","close_reason":"Validation run complete — fd-v2 agents (now fd-*) successfully reviewed their own implementation diff. Agents renamed, v1 deleted, all refs updated."}
{"id":"Clavain-hau","title":"CREATION-LOG.md orphan in systematic-debugging","description":"skills/systematic-debugging/ contains a CREATION-LOG.md file that appears to be an orphaned artifact from skill creation. Consider removing.","status":"closed","priority":4,"issue_type":"bug","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-08T00:25:22.934806112-08:00","created_by":"mk","updated_at":"2026-02-08T09:00:55.092976324-08:00","closed_at":"2026-02-08T09:00:55.092976324-08:00","close_reason":"Closed"}
{"id":"Clavain-hsz","title":"Create agent-rig-assembly integration skill","description":"Glue skill that wires beads + agent-mail + Agent SDK + Codex + Claude Code together. Contains integration patterns: beads for cross-session state in Agent SDK apps, agent-mail for multi-agent coordination, interclode for parallel execution, deployment of the full stack. Thin shim that composes tools, not a monolith.","status":"closed","priority":1,"issue_type":"feature","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-08T01:03:02.412990706-08:00","created_by":"mk","updated_at":"2026-02-08T01:06:40.932340372-08:00","closed_at":"2026-02-08T01:06:40.932340372-08:00","close_reason":"Wrong framing — Clavain is a modpack, not a monolith. Replacing with modpack-oriented issues.","dependencies":[{"issue_id":"Clavain-hsz","depends_on_id":"Clavain-0xm","type":"blocks","created_at":"2026-02-08T01:03:07.440503316-08:00","created_by":"mk"},{"issue_id":"Clavain-hsz","depends_on_id":"Clavain-4pj","type":"blocks","created_at":"2026-02-08T01:03:07.487133713-08:00","created_by":"mk"}]}
{"id":"Clavain-ih6","title":"flux-drive: agent-specific diff slicing for token efficiency","description":"When input is a large diff (1000+ lines), flux-drive sends the full diff to every agent. For the v2 validation run, 3 agents each received 1787 lines = ~5400 lines total. Optimization: slice the diff by file paths into agent-specific sections. E.g., fd-v2-architecture gets only agents/review/*.md + SKILL.md + shared-contracts.md hunks; fd-v2-quality gets agents/review/*.md + validate-roster.sh + knowledge/README.md hunks. Tricky: diff hunks often contain cross-cutting context. May need to include the full diff header + file list for all agents, but only relevant hunks per agent. launch.md already has a 1000+ lines exception — this would implement it for diff inputs.","status":"in_progress","priority":3,"issue_type":"feature","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-10T12:18:15.650267118-08:00","created_by":"mk","updated_at":"2026-02-10T21:26:53.144797491-08:00"}
{"id":"Clavain-isq","title":"Complete escape_for_json to handle all JSON-illegal control characters","description":"hooks/lib.sh escape_for_json handles backslash, double-quote, newline, CR, tab but omits U+0000-U+001F control chars (backspace, form feed, etc). Could produce invalid JSON from adversarial upstream content. Either extend bash implementation or delegate to jq/python. Source: flux-drive SEC-5 (MEDIUM).","status":"closed","priority":2,"issue_type":"bug","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-08T22:20:59.187663353-08:00","created_by":"mk","updated_at":"2026-02-09T00:14:36.780492239-08:00","closed_at":"2026-02-09T00:14:36.780492239-08:00","close_reason":"escape_for_json now handles all U+0001-U+001F control chars. Named escapes for \\b \\f, \\u00XX for rest."}
{"id":"Clavain-j25","title":"Implement Tier 1 structural tests (pytest)","description":"Create tests/structural/ with pytest tests validating plugin structure: plugin manifest (test_plugin_manifest.py), hooks.json (test_hooks_json.py), agents (test_agents.py), skills (test_skills.py), commands (test_commands.py), cross-references (test_cross_references.py), scripts (test_scripts.py), plus conftest.py with shared fixtures. Must exclude agents/review/references/ from agent globs. Per plan: docs/plans/2026-02-10-test-suite-design.md Steps 1-2.","status":"closed","priority":2,"issue_type":"task","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-10T12:18:04.338400567-08:00","created_by":"mk","updated_at":"2026-02-10T12:57:00.72252349-08:00","closed_at":"2026-02-10T12:57:00.72252349-08:00","close_reason":"521 pytest tests passing in 0.72s across 8 modules","dependencies":[{"issue_id":"Clavain-j25","depends_on_id":"Clavain-vpf","type":"blocks","created_at":"2026-02-10T12:18:20.90118728-08:00","created_by":"mk"}]}
{"id":"Clavain-kls","title":"Trim using-clavain session injection from ~2160 to ~900 tokens","description":"using-clavain SKILL.md (8.6KB) is injected via additionalContext on every session. The key commands quick reference (~2.4KB) is rarely needed at start. Split into essential routing (~40 lines) + on-demand reference. 58% reduction. Source: flux-drive P0-4.","status":"closed","priority":1,"issue_type":"feature","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-08T22:19:10.018944876-08:00","created_by":"mk","updated_at":"2026-02-09T00:36:31.306249722-08:00","closed_at":"2026-02-09T00:36:31.306249722-08:00","close_reason":"Trimmed using-clavain SKILL.md 29.6% (8561→6025 bytes). Removed Key Commands Quick Reference, Skill Types, Plugin Conflicts, User Instructions sections."}
{"id":"Clavain-ko8","title":"Add retry/error handling for Task-dispatched flux-drive agents","description":"Codex dispatch path (phases/launch-codex.md:100-105) has retry logic and fallback. Default Task dispatch path has none — if a background Task agent fails silently, it shows as 'no findings' with no retry. Mirror the Codex path: check for missing findings files, retry once, note failures in synthesis summary.","status":"closed","priority":2,"issue_type":"task","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-09T08:38:04.149118764-08:00","created_by":"mk","updated_at":"2026-02-09T08:52:31.449353486-08:00","closed_at":"2026-02-09T08:52:31.449353486-08:00","close_reason":"Closed"}
{"id":"Clavain-ks4","title":"pr-comment-resolver orphan color: blue field","description":"agents/workflow/pr-comment-resolver.md has undocumented color: blue frontmatter field. No other agent uses it, not documented in AGENTS.md. Either document or remove.","status":"closed","priority":4,"issue_type":"bug","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-08T00:25:14.469179809-08:00","created_by":"mk","updated_at":"2026-02-08T09:00:55.122164887-08:00","closed_at":"2026-02-08T09:00:55.122164887-08:00","close_reason":"Closed"}
{"id":"Clavain-kto","title":"Fix Oracle timeout inconsistency in flux-drive","description":"SKILL.md roster specifies 'timeout 300' (5 min) in the Oracle bash command example, but phases/launch.md:49 says 'timeout: 600000' (10 min) for the Bash tool call. These should match — pick one value and use it consistently.","status":"closed","priority":3,"issue_type":"bug","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-09T08:38:06.269151483-08:00","created_by":"mk","updated_at":"2026-02-09T08:52:47.720979613-08:00","closed_at":"2026-02-09T08:52:47.720979613-08:00","close_reason":"Closed"}
{"id":"Clavain-l32","title":"P1: Routing table missing 7+ commands and 2 skills","description":"- type: bug","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-02-07T13:42:34.468950549-08:00","updated_at":"2026-02-07T22:46:22.598878361-08:00","closed_at":"2026-02-07T22:46:22.598878361-08:00","close_reason":"Closed","labels":["flux-drive"]}
{"id":"Clavain-l43","title":"Merge 4 cross-AI skills into single skill with escalation modes","description":"interpeer, prompterpeer, winterpeer, splinterpeer total ~1411 lines and form a strict escalation chain. Each contains duplicate comparison tables. Merge into one cross-ai-review skill with modes: quick/deep/council/mine. Eliminates ~400 lines of duplication. Source: flux-drive P2-5 (2 agents).","status":"closed","priority":3,"issue_type":"feature","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-08T22:20:53.651975908-08:00","created_by":"mk","updated_at":"2026-02-09T01:05:47.863547943-08:00","closed_at":"2026-02-09T01:05:47.863547943-08:00","close_reason":"Merged 4 cross-AI skills (interpeer/prompterpeer/winterpeer/splinterpeer) into unified interpeer skill with quick/deep/council/mine modes. 1411→386 lines (73% reduction). Thin redirects preserve backward compatibility. Oracle references moved from winterpeer/ to interpeer/. upstreams.json updated."}
{"id":"Clavain-ljy","title":"Strengthen file-write instruction in flux-drive agent prompts","description":"Agents spawned via Task(run_in_background: true) may return text to caller instead of writing to OUTPUT_DIR. The 'Write your findings to:' instruction is in the task prompt, not system prompt, and nothing forces agents to use the Write tool. Phase 3 polls OUTPUT_DIR via ls and will time out if files aren't created. Fix: add forceful instruction — 'Your FIRST action must be to use the Write tool to create {OUTPUT_DIR}/{agent-name}.md. All output goes in that file.'","status":"closed","priority":1,"issue_type":"bug","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-09T08:37:59.007607078-08:00","created_by":"mk","updated_at":"2026-02-09T08:50:03.212153948-08:00","closed_at":"2026-02-09T08:50:03.212153948-08:00","close_reason":"Closed","dependencies":[{"issue_id":"Clavain-ljy","depends_on_id":"Clavain-cna","type":"blocks","created_at":"2026-02-09T08:38:11.178170989-08:00","created_by":"mk"}]}
{"id":"Clavain-m2v","title":"Fix scoring: category bonus should not elevate base-0 agents","design":"docs/plans/plan-clavain-m2v.md","status":"closed","priority":3,"issue_type":"bug","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-09T14:57:54.434596661-08:00","created_by":"mk","updated_at":"2026-02-10T08:44:52.41630488-08:00","closed_at":"2026-02-10T08:44:52.41630488-08:00","close_reason":"Closed"}
{"id":"Clavain-m3n","title":"P0: agent-native-architecture still has 9 XML tag pairs","status":"closed","priority":0,"issue_type":"bug","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-08T00:23:25.017783822-08:00","created_by":"mk","updated_at":"2026-02-08T00:36:15.176992457-08:00","closed_at":"2026-02-08T00:36:15.176992457-08:00","close_reason":"Closed"}
{"id":"Clavain-m7s","title":"Refine Tier 3 smoke tests and prompt","description":"Smoke test script (tests/smoke/run-smoke-tests.sh) and prompt (tests/smoke/smoke-prompt.md) exist and work (8/8 pass). Improvements needed: consider stronger override of MANDATORY FIRST STEP wrapper, add timeout per-agent, add --verbose flag for detailed output, document the instruction-conflict pattern in the prompt comments. See docs/solutions/best-practices/smoke-test-agent-instruction-conflict-20260210.md for findings.","status":"closed","priority":3,"issue_type":"task","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-10T12:18:11.38673588-08:00","created_by":"mk","updated_at":"2026-02-10T13:00:31.587793293-08:00","closed_at":"2026-02-10T13:00:31.587793293-08:00","close_reason":"Added instruction-conflict documentation to smoke-prompt.md"}
{"id":"Clavain-mgs","title":"Add knowledge injection to launch.md","description":"Add Step 2.1a for qmd retrieval of knowledge entries. Update prompt template with Knowledge Context section. Add provenance markers.","status":"closed","priority":1,"issue_type":"task","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-10T09:42:21.214597455-08:00","created_by":"mk","updated_at":"2026-02-10T09:59:17.679551094-08:00","closed_at":"2026-02-10T09:59:17.679551094-08:00","close_reason":"Phase 3 complete — all Codex agents succeeded","dependencies":[{"issue_id":"Clavain-mgs","depends_on_id":"Clavain-uid","type":"blocks","created_at":"2026-02-10T09:42:28.61788524-08:00","created_by":"mk"}]}
{"id":"Clavain-mr7","title":"Refactor flux-drive launch shared contracts","description":"Extract shared launch contracts to shared-contracts.md and slim launch.md + launch-codex.md per Clavain-apn request","status":"closed","priority":2,"issue_type":"task","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-10T08:47:57.369758113-08:00","created_by":"mk","updated_at":"2026-02-10T08:50:36.85365029-08:00","closed_at":"2026-02-10T08:50:36.85365029-08:00","close_reason":"Closed"}
{"id":"Clavain-muk","title":"P1: Duplicate brainstorming/SKILL.md mapping in upstreams.json","description":"- type: bug","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-02-07T13:42:34.472140662-08:00","updated_at":"2026-02-07T22:44:29.842663915-08:00","closed_at":"2026-02-07T22:44:29.842663915-08:00","close_reason":"Closed","labels":["flux-drive"]}
{"id":"Clavain-n2l","title":"P1: learnings command duplicates engineering-docs — convert to thin shim","status":"closed","priority":1,"issue_type":"task","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-08T00:23:30.358956544-08:00","created_by":"mk","updated_at":"2026-02-08T04:21:04.147591107-08:00","closed_at":"2026-02-08T04:21:04.147591107-08:00","close_reason":"Closed"}
{"id":"Clavain-ne6","title":"Simplify Phase 4: keep cross-AI classification, add consent gate, target 30-40 lines","description":"Rewrite cross-ai.md from 97 lines to ~30-40 lines. From 3-model debate consensus.\n\nAcceptance criteria (absorbs Clavain-c7i, Clavain-c6m, Clavain-f0m):\n1. If Oracle absent: offer interpeer quick mode WITH 1-sentence description of what it does/costs (was Clavain-c6m)\n2. If Oracle present: produce Agreement/Oracle-only/Claude-only/Disagreement counts, show top findings\n3. AskUserQuestion consent gate before any interpeer escalation — no auto-chain (was Clavain-c7i)\n4. Add explicit skip condition in SKILL.md before Phase 4 file read: 'If Oracle not in roster, skip' (was Clavain-f0m)\n5. Remove Steps 4.3-4.5 auto-chain and sequential decision prompts\n6. Single consolidated escalation prompt with context for each option\n\nFiles: skills/flux-drive/phases/cross-ai.md (rewrite), skills/flux-drive/SKILL.md (add skip gate)","status":"closed","priority":2,"issue_type":"task","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-09T14:57:42.537586077-08:00","created_by":"mk","updated_at":"2026-02-09T20:29:23.171393731-08:00","closed_at":"2026-02-09T20:29:23.171393731-08:00","close_reason":"Rewrote cross-ai.md from 97 to 30 lines. Added SKILL.md skip gate, consent gate via AskUserQuestion, 2-category classification (blind spots + conflicts), decoupled interpeer integration section."}
{"id":"Clavain-nta","title":"Fix parallel dispatch correctness: atomic rename, run scoping, retry guards, timeout","description":"Consolidates Clavain-563, Clavain-r5t, Clavain-8xs. All three modify Step 2.2-2.3 of launch.md.\n\nAcceptance criteria (from 3-model debate consensus):\n1. Universal completion protocol: agents write to {name}.md.partial, rename to {name}.md on completion\n2. End-of-file sentinel: last line must be \u003c!-- flux-drive:complete --\u003e\n3. Run scoping: OUTPUT_DIR includes timestamp or is cleaned at start to prevent stale-write contamination\n4. Retry guard: re-check file existence before retry AND before stub write. Never overwrite non-stub\n5. Foreground retry timeout: 5 min cap (timeout: 300000)\n6. Oracle path: write to .tmp.md, rename on success, write verdict:error on failure before rename\n\nFiles to modify: skills/flux-drive/phases/launch.md (Steps 2.2-2.3), skills/flux-drive/SKILL.md (OUTPUT_DIR definition)","status":"closed","priority":0,"issue_type":"task","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-09T15:15:22.547027859-08:00","created_by":"mk","updated_at":"2026-02-09T20:55:11.574786931-08:00","closed_at":"2026-02-09T20:55:11.574786931-08:00","close_reason":"Atomic rename (.partial→.md), sentinel (flux-drive:complete), run isolation (clean stale files), pre-retry guard, 5-min retry timeout, Oracle verdict:error stub on failure. Changes in launch.md Steps 2.0/2.2/2.3 and SKILL.md OUTPUT_DIR/Oracle command."}
{"id":"Clavain-ojt","title":"Consolidate 3 resolve-* commands into single /resolve","description":"resolve-parallel, resolve-todo-parallel, resolve-pr-parallel share identical 4-step workflow, differ only in input source (grep, files, gh). Merge into one /resolve command with auto-detection or --source flag. Source: flux-drive P1-10 (3 agents agree).","status":"closed","priority":3,"issue_type":"feature","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-08T22:20:46.615323209-08:00","created_by":"mk","updated_at":"2026-02-09T07:57:26.793757092-08:00","closed_at":"2026-02-09T07:57:26.793757092-08:00","close_reason":"Closed"}
{"id":"Clavain-old","title":"flux-drive: Enforce section trimming for token optimization (Phase 2)","status":"closed","priority":2,"issue_type":"task","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-08T14:29:19.762712094-08:00","created_by":"mk","updated_at":"2026-02-08T14:31:38.755995482-08:00","closed_at":"2026-02-08T14:31:38.755995482-08:00","close_reason":"Replaced vague trimming instruction with explicit numbered rules, 50% target, and per-agent section mapping"}
{"id":"Clavain-oxr","title":"Update SKILL.md roster and triage for 6 agents","description":"Replace 19-agent Plugin Agents table with 6-agent table. Update pre-filter rules, scoring examples, domain-general list. Keep Project Agents, Oracle, cap at 8.","status":"closed","priority":1,"issue_type":"task","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-10T09:42:20.076883335-08:00","created_by":"mk","updated_at":"2026-02-10T09:55:58.484240815-08:00","closed_at":"2026-02-10T09:55:58.484240815-08:00","close_reason":"Closed","dependencies":[{"issue_id":"Clavain-oxr","depends_on_id":"Clavain-7nk","type":"blocks","created_at":"2026-02-10T09:42:28.53219916-08:00","created_by":"mk"}]}
{"id":"Clavain-p86","title":"/lfg: add test/verification gate before quality-gates","description":"/quality-gates says 'run after tests pass' but /lfg doesn't include a hard test gate step. Clodex-mode execution may skip /work which contains continuous testing guidance. Insert explicit verification step before quality-gates: run project test + lint commands and fail fast. Could use verification-before-completion skill. Source: Oracle interpeer deep review Finding 14.","status":"closed","priority":3,"issue_type":"feature","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-09T07:08:26.478127804-08:00","created_by":"mk","updated_at":"2026-02-09T07:18:15.673876242-08:00","closed_at":"2026-02-09T07:18:15.673876242-08:00","close_reason":"Closed"}
{"id":"Clavain-pai","title":"Commit 3 uncommitted PRD agents (product-skeptic, strategic-reviewer, user-advocate)","description":"3 PRD agents exist on disk but were never committed. The flux-drive roster (SKILL.md lines 212-214), AGENTS.md, and README.md all reference them, but published plugin v0.4.13 doesn't include them. Anyone installing Clavain gets a roster that references agents that don't exist. Fix: git add and commit the 3 files.","status":"closed","priority":1,"issue_type":"bug","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-09T11:42:17.554237375-08:00","created_by":"mk","updated_at":"2026-02-09T11:53:34.495366003-08:00","closed_at":"2026-02-09T11:53:34.495366003-08:00","close_reason":"Staged 3 PRD agent files for commit"}
{"id":"Clavain-qrh","title":"/quality-gates: specify diff-driven reviewer context","description":"/quality-gates selects agents by file extension but doesn't specify what context agents actually review. Standardize: unified diff (git diff HEAD + git diff --cached), list of changed files with reasons, relevant config if touched. Ask reviewers to reference diff hunks in findings (file:line). Source: Oracle interpeer deep review Finding 16.","status":"closed","priority":2,"issue_type":"feature","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-09T07:08:14.370423407-08:00","created_by":"mk","updated_at":"2026-02-09T07:16:41.44085415-08:00","closed_at":"2026-02-09T07:16:41.44085415-08:00","close_reason":"Closed"}
{"id":"Clavain-r5t","title":"Guard agent lifecycle: re-check before retry/stub, never overwrite non-stub","status":"closed","priority":0,"issue_type":"task","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-09T14:57:35.931295464-08:00","created_by":"mk","updated_at":"2026-02-09T15:16:12.135228997-08:00","closed_at":"2026-02-09T15:16:12.135228997-08:00","close_reason":"Consolidated into Clavain-nta"}
{"id":"Clavain-rwi","title":"Assign model: sonnet/haiku to mechanical review agents","description":"28 of 29 agents use model: inherit (Opus-class). Assign model: sonnet to fd-code-quality, fd-user-experience, pattern-recognition-specialist, shell-reviewer, code-simplicity-reviewer, deployment-verification-agent. Assign model: haiku to git-history-analyzer. ~50-60% cost reduction. Source: flux-drive P1-13.","status":"closed","priority":2,"issue_type":"feature","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-08T22:20:35.452427917-08:00","created_by":"mk","updated_at":"2026-02-09T00:40:30.951347961-08:00","closed_at":"2026-02-09T00:40:30.951347961-08:00","close_reason":"Assigned model: sonnet to 6 mechanical review agents, model: haiku to git-history-analyzer via Codex dispatch."}
{"id":"Clavain-rzn","title":"Merge Tier 1/3 agent pairs into conditional agents","description":"fd-architecture/architecture-strategist, fd-security/security-sentinel, fd-performance/performance-oracle cover same domains at 2 tiers. Merge each pair into one agent that conditionally reads project docs when available. Eliminates 3 agents and ~250 lines. Source: flux-drive P2-4 (code-simplicity).","status":"closed","priority":3,"issue_type":"feature","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-08T22:20:49.710295198-08:00","created_by":"mk","updated_at":"2026-02-09T07:57:26.77516174-08:00","closed_at":"2026-02-09T07:57:26.77516174-08:00","close_reason":"Closed"}
{"id":"Clavain-s3j","title":"Implement incremental depth: launch top agents first, expand on demand","description":"Instead of launching all selected agents simultaneously, implement a two-stage dispatch: Stage 1: Launch the top 2-3 highest-scoring agents. Wait for results. Stage 2: Based on findings, decide whether to launch additional agents: - If top agents found P0 issues → launch remaining agents for convergence data. - If top agents found only minor/no issues → stop early, save 50%+ of agent tokens. - If agents disagree → launch a specific tiebreaker agent. This is 'early stopping' for agent dispatch. Current system launches everything regardless of whether findings warrant full coverage. Expected savings: 30-50% on easy/clean reviews where top 2-3 agents find nothing concerning. Quality impact: neutral to positive — specialists still get launched when needed, and the early-stop decision is informed by actual findings, not just triage scores. Files: skills/flux-drive/SKILL.md (Phase 1 triage changes), skills/flux-drive/phases/launch.md (staged dispatch), skills/flux-drive/phases/synthesize.md (handle partial agent sets)","design":"docs/plans/plan-clavain-s3j.md","status":"closed","priority":1,"issue_type":"feature","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-09T18:14:47.397228906-08:00","created_by":"mk","updated_at":"2026-02-10T08:27:52.316197484-08:00","closed_at":"2026-02-10T08:27:52.316197484-08:00","close_reason":"Closed"}
{"id":"Clavain-s65","title":"Add spec-flow-analyzer to flux-drive roster or remove from scoring example","description":"spec-flow-analyzer appears in the PRD scoring example (SKILL.md line 142) but is NOT listed in any roster table (Domain Specialists, Adaptive Reviewers, or Cross-AI). It lives at agents/workflow/spec-flow-analyzer.md with subagent_type clavain:workflow:spec-flow-analyzer. Either add it to the Adaptive Reviewers table or remove from the scoring example to avoid confusion.","status":"closed","priority":2,"issue_type":"bug","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-09T11:42:21.050219665-08:00","created_by":"mk","updated_at":"2026-02-09T11:56:42.555904895-08:00","closed_at":"2026-02-09T11:56:42.555904895-08:00","close_reason":"Codex agents completed all 3 tasks successfully"}
{"id":"Clavain-sjr","title":"P1: plan-reviewer.md uses YAML block scalar instead of inline quoted","status":"closed","priority":1,"issue_type":"task","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-08T00:23:37.604628836-08:00","created_by":"mk","updated_at":"2026-02-08T04:21:04.06704047-08:00","closed_at":"2026-02-08T04:21:04.06704047-08:00","close_reason":"Closed"}
{"id":"Clavain-th4","title":"Fix Agent Roster: tier vocabulary, spec-flow-analyzer categorization, table cleanup","description":"Consolidates Clavain-th4 and Clavain-4q1. Both are single-edit changes to the Agent Roster table in SKILL.md.\n\nAcceptance criteria:\n1. Remove 'domain' from tier enum in YAML/markdown output spec — no agents use it. Canonical tiers: project, adaptive, cross-ai\n2. Standardize tier vocabulary across SKILL.md, launch.md, and launch-codex.md\n3. Move spec-flow-analyzer to its own 'Workflow Agents' sub-table (it uses clavain:workflow: subagent_type, not clavain:review:)\n4. Or: rename 'Adaptive Reviewers' to 'Plugin Agents' to accurately describe all non-Project, non-Oracle agents\n\nFiles: skills/flux-drive/SKILL.md (roster section), skills/flux-drive/phases/launch.md (tier in prompt template)","design":"docs/plans/plan-clavain-th4.md","status":"closed","priority":3,"issue_type":"bug","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-09T14:57:46.147913412-08:00","created_by":"mk","updated_at":"2026-02-10T08:27:52.235138328-08:00","closed_at":"2026-02-10T08:27:52.235138328-08:00","close_reason":"Closed"}
{"id":"Clavain-u3s","title":"P1: Agent Mail MCP server has no authentication","description":"- type: bug","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-02-07T13:42:34.476263545-08:00","updated_at":"2026-02-07T22:49:48.001883819-08:00","closed_at":"2026-02-07T22:49:48.001883819-08:00","close_reason":"Agent Mail MCP runs on 127.0.0.1:8765 (localhost only). Authentication is unnecessary for loopback services — only local processes can reach it. Not a security issue.","labels":["flux-drive"]}
{"id":"Clavain-ud3","title":"fd-* agents: document as flux-drive internals in routing table","description":"fd-architecture, fd-security, fd-code-quality, fd-performance, fd-user-experience are flux-drive-scoped Tier 1 agents but appear alongside general reviewers in agent roster. Users may invoke the wrong agent directly. Document fd-* as flux-drive internals (auto-selected by flux-drive, not for direct invocation) or note this clearly in the routing table. Source: Oracle interpeer deep review Finding 9.","status":"closed","priority":3,"issue_type":"feature","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-09T07:08:23.721860085-08:00","created_by":"mk","updated_at":"2026-02-09T07:16:41.459356467-08:00","closed_at":"2026-02-09T07:16:41.459356467-08:00","close_reason":"Closed"}
{"id":"Clavain-ufd","title":"Evaluate two-pass architecture: triage agent → targeted specialists","description":"Alternative architecture for flux-drive that could save 40-60% of tokens. Pass 1 (cheap): A single lightweight 'triage agent' reads the full document and produces a structured list of concerns tagged by domain (security, architecture, performance, etc.). This agent doesn't need deep expertise — just the ability to flag 'this section has a security implication'. Pass 2 (targeted): Launch specialist agents ONLY for domains where Pass 1 flagged actual concerns. Each specialist gets the relevant document section + the triage flag, not the full document. If Pass 1 finds concerns in 2 of 6 domains, Pass 2 launches 2 agents instead of 6. Document duplication drops from 6× to 2×. Risk: triage agent might miss things only a specialist would catch. Needs testing against current approach on 5-10 real reviews to measure quality delta. This is a larger architectural change — create a prototype first. Files: skills/flux-drive/SKILL.md (new architecture), skills/flux-drive/phases/ (all phases affected)","design":"docs/plans/plan-clavain-ufd.md","status":"closed","priority":2,"issue_type":"feature","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-09T18:15:06.089836556-08:00","created_by":"mk","updated_at":"2026-02-10T08:21:18.321804311-08:00","closed_at":"2026-02-10T08:21:18.321804311-08:00","close_reason":"Deferred. Clavain-s3j (incremental depth) achieves 30-50% token savings with simpler architecture and less risk. Two-pass introduces a triage agent single point of failure and requires domain taxonomy calibration. Revisit if s3j delivers \u003c20% savings in practice."}
{"id":"Clavain-uid","title":"Create knowledge directory and format docs","description":"Create config/flux-drive/knowledge/.gitkeep and README.md documenting entry format, provenance rules, decay rules, sanitization rules.","status":"closed","priority":2,"issue_type":"task","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-10T09:42:18.685369514-08:00","created_by":"mk","updated_at":"2026-02-10T09:54:04.042699424-08:00","closed_at":"2026-02-10T09:54:04.042699424-08:00","close_reason":"Closed"}
{"id":"Clavain-urz","title":"Implement flux-drive v2 MVP: 6 core agents + single-tier knowledge + silent compounding","description":"Architecture doc: docs/research/flux-drive-v2-architecture.md. Replace 19 specialized agents with 6 core agents (Architecture \u0026 Design, Safety, Correctness, Quality \u0026 Style, User \u0026 Product, Performance) + Oracle. Add single-tier knowledge layer in config/flux-drive/knowledge/ with qmd retrieval (5 entries/agent cap). Add silent post-synthesis compounding hook (Sonnet model). Includes provenance tracking, evidence anchors, sanitization rule, first-run bootstrap, and retraction mechanism. Validation plan: run controlled comparison on 3 recent reviews before shipping.","status":"closed","priority":1,"issue_type":"feature","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-10T08:52:00.306403723-08:00","created_by":"mk","updated_at":"2026-02-10T09:59:23.315278366-08:00","closed_at":"2026-02-10T09:59:23.315278366-08:00","close_reason":"All 6 implementation beads complete: 6 core agents, knowledge layer, SKILL.md roster, knowledge injection, silent compounding, validate-roster"}
{"id":"Clavain-uyt","title":"Clarify document trimming responsibility in flux-drive prompt template","description":"phases/launch.md:76-84 Token Optimization block is ambiguous — reads as instruction to the agent but should be work done by the orchestrator before pasting. If flux-drive includes full doc and expects agent to trim, 100% of tokens are sent anyway. Fix: orchestrator trims before pasting, remove the Token Optimization block from agent-facing prompt.","status":"closed","priority":1,"issue_type":"bug","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-09T08:37:56.329226037-08:00","created_by":"mk","updated_at":"2026-02-09T08:50:03.222386966-08:00","closed_at":"2026-02-09T08:50:03.222386966-08:00","close_reason":"Closed","dependencies":[{"issue_id":"Clavain-uyt","depends_on_id":"Clavain-cna","type":"blocks","created_at":"2026-02-09T08:38:11.130801663-08:00","created_by":"mk"}]}
{"id":"Clavain-vbt","title":"Merge claude-automation-recommender into Clavain","description":"Pull claude-automation-recommender skill from official claude-code-setup plugin. Analyzes codebases and recommends Claude Code automations (hooks, skills, MCP servers, subagents). Medium value — useful but not core to agent rig.","status":"closed","priority":3,"issue_type":"feature","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-08T01:03:02.42141193-08:00","created_by":"mk","updated_at":"2026-02-08T01:06:36.295835531-08:00","closed_at":"2026-02-08T01:06:36.295835531-08:00","close_reason":"Wrong framing — Clavain is a modpack, not a monolith. Replacing with modpack-oriented issues."}
{"id":"Clavain-vpf","title":"Reconcile agent/command counts across docs","description":"Filesystem has 35 agents (27 review + 5 research + 3 workflow) but CLAUDE.md, AGENTS.md, and plugin.json all say 29. The 6 fd-v2 agents were added without doc updates. Also AGENTS.md says 27 commands but filesystem has 24. Update all three files to match reality. Must happen before writing test count assertions.","status":"closed","priority":1,"issue_type":"task","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-10T12:18:00.613399801-08:00","created_by":"mk","updated_at":"2026-02-10T12:25:30.46559691-08:00","closed_at":"2026-02-10T12:25:30.46559691-08:00","close_reason":"Updated CLAUDE.md, AGENTS.md, and plugin.json: 29→35 agents, 21→27 review agents"}
{"id":"Clavain-vte","title":"Create agent-observability skill","description":"Token tracking, error monitoring, cost dashboards for production agent rigs. References agent-mail's observability.md and operations_alignment_checklist.md. Pattern guidance, not tooling.","status":"closed","priority":3,"issue_type":"feature","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-08T01:03:02.416938761-08:00","created_by":"mk","updated_at":"2026-02-08T01:06:36.290803614-08:00","closed_at":"2026-02-08T01:06:36.290803614-08:00","close_reason":"Wrong framing — Clavain is a modpack, not a monolith. Replacing with modpack-oriented issues."}
{"id":"Clavain-weo","title":"Sanitize GitHub Actions script injection in pr-agent-commands.yml","description":"PR comment body interpolated directly into JS template literals via ${{ }} expressions instead of process.env. Affects pr-agent-commands.yml:75,203. Replace with env: + process.env pattern. Source: flux-drive SEC-1 (HIGH).","status":"closed","priority":0,"issue_type":"bug","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-08T22:20:03.245575313-08:00","created_by":"mk","updated_at":"2026-02-09T00:14:36.590467709-08:00","closed_at":"2026-02-09T00:14:36.590467709-08:00","close_reason":"All ${{ }} expressions moved to env: blocks in pr-agent-commands.yml. Zero script injection vectors remain."}
{"id":"Clavain-wf3","title":"/lfg: reorder so plan-review gates execution, pass plan path to /work","description":"Currently /lfg runs: brainstorm → plan → execute → review plan (flux-drive) → code review → quality-gates. Reviewing the plan after executing it is backward. Reorder: brainstorm → write-plan → plan-review (gate) → execute → quality-gates → resolve → ship. Also pass the plan file path from Step 2 into /work in Step 3 so execution isn't ambiguous. Source: Oracle interpeer deep review Findings 12+13.","status":"closed","priority":2,"issue_type":"bug","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-09T07:08:10.353383489-08:00","created_by":"mk","updated_at":"2026-02-09T07:18:15.666450823-08:00","closed_at":"2026-02-09T07:18:15.666450823-08:00","close_reason":"Closed"}
{"id":"Clavain-wjh","title":"flux-drive: Add model hints for Tier 3 agents (Phase 1)","status":"closed","priority":2,"issue_type":"task","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-08T14:29:20.733430062-08:00","created_by":"mk","updated_at":"2026-02-08T14:31:10.867610545-08:00","closed_at":"2026-02-08T14:31:10.867610545-08:00","close_reason":"Added Model column to Tier 3 table: haiku for pattern matching, sonnet for reasoning-heavy domains"}
{"id":"Clavain-y0i","title":"Split flux-drive SKILL.md into progressive phase files","description":"flux-drive at 745 lines/32KB is the largest skill. Contains 4 phases, Codex dispatch (4.5KB dead weight in Task path), and cross-AI escalation. Split into SKILL.md entry point (~2KB) + phases/launch.md + phases/launch-codex.md + phases/synthesize.md + phases/cross-ai.md. Reduces initial load from 32KB to ~2KB. Source: flux-drive P1-12.","status":"closed","priority":3,"issue_type":"feature","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-08T22:20:43.698727264-08:00","created_by":"mk","updated_at":"2026-02-09T08:02:05.020556018-08:00","closed_at":"2026-02-09T08:02:05.020556018-08:00","close_reason":"Closed"}
{"id":"Clavain-y5r","title":"SessionStart hook: downgrade companions to FYI, fix stderr mixing, portable stat","description":"Three hook improvements: (1) Companion detection wrapped in EXTREMELY_IMPORTANT — should be FYI-level, only elevate when actionable. (2) cat SKILL.md 2\u003e\u00261 mixes stderr into injected content — should fail gracefully with short error note. (3) stat -c is GNU-specific, breaks on macOS/BSD — use portable alternative or fallback. Source: Oracle interpeer deep review Findings 18-20.","status":"closed","priority":3,"issue_type":"bug","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-09T07:08:20.7603001-08:00","created_by":"mk","updated_at":"2026-02-09T07:16:41.449804898-08:00","closed_at":"2026-02-09T07:16:41.449804898-08:00","close_reason":"Closed"}
{"id":"Clavain-yg0","title":"Fix CLAUDE.md validation comment (28→29) and add Rust to language list","description":"CLAUDE.md:17 says Should be 28 but actual agent count is 29. CLAUDE.md:31 lists Go/Python/TypeScript/Shell but omits Rust despite rust-reviewer.md existing. Fix: 2 line edits. Source: flux-drive P0-2, P1-1.","status":"closed","priority":0,"issue_type":"bug","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-08T22:19:07.664476096-08:00","created_by":"mk","updated_at":"2026-02-08T23:07:54.178245297-08:00","closed_at":"2026-02-08T23:07:54.178245297-08:00","close_reason":"Closed"}
{"id":"Clavain-yl2","title":"Extract concurrency-reviewer code examples to references/ directory","description":"concurrency-reviewer.md at 606 lines/20KB has inline Go, Python, TypeScript, Shell, JS examples across 11 sections. Extract to agents/review/references/concurrency-patterns.md. Reduces per-dispatch from ~5000 to ~1500 tokens. Source: flux-drive P2-14 (2 agents).","status":"closed","priority":3,"issue_type":"task","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-08T22:20:56.134761699-08:00","created_by":"mk","updated_at":"2026-02-09T00:36:31.488201639-08:00","closed_at":"2026-02-09T00:36:31.488201639-08:00","close_reason":"Extracted 30 code blocks from concurrency-reviewer.md to references/concurrency-patterns.md. Reviewer reduced from 606→151 lines."}
{"id":"Clavain-ymf","title":"Fix /work Phase 4 step numbering (jumps from 2 to 4)","description":"commands/work.md Phase 4 Ship has steps 1, 2, 4 — step 3 is missing. Likely a copy-paste artifact where step 3 was deleted without renumbering. Source: flux-drive P2-6.","status":"closed","priority":2,"issue_type":"bug","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-08T22:21:06.76841561-08:00","created_by":"mk","updated_at":"2026-02-08T23:07:54.205541529-08:00","closed_at":"2026-02-08T23:07:54.205541529-08:00","close_reason":"Closed"}
{"id":"Clavain-z18","title":"P1: brainstorm.md mapped from two upstreams — merge ambiguity","status":"closed","priority":1,"issue_type":"bug","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-08T00:23:37.769597558-08:00","created_by":"mk","updated_at":"2026-02-08T04:21:04.125209498-08:00","closed_at":"2026-02-08T04:21:04.125209498-08:00","close_reason":"Closed"}
{"id":"Clavain-z9q","title":"Architecture diagrams omit 2 hook scripts","description":"AGENTS.md architecture section mentions hooks but doesn't list all 3 scripts (session-start.sh, agent-mail-register.sh, dotfiles-sync.sh) in the directory structure diagram.","status":"closed","priority":4,"issue_type":"bug","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-08T00:25:15.829011926-08:00","created_by":"mk","updated_at":"2026-02-08T08:38:40.291699133-08:00","closed_at":"2026-02-08T08:38:40.291699133-08:00","close_reason":"Already fixed — AGENTS.md lines 41-43 list all 3 hook scripts"}
{"id":"Clavain-zhs","title":"P0: Broken upstreams.json fileMap — 5 underscore filenames","description":"- type: bug","status":"closed","priority":0,"issue_type":"bug","created_at":"2026-02-07T13:42:34.465598771-08:00","updated_at":"2026-02-07T20:12:20.537495036-08:00","closed_at":"2026-02-07T20:12:20.537495036-08:00","close_reason":"Closed","labels":["flux-drive"]}
{"id":"Clavain-zkm","title":"/work: remove PR language, single trunk-based commit workflow","description":"/work Phase 4 has contradictory shipping semantics — says trunk-based but also mentions 'Link to PR' and includes two different commit workflows. Remove all PR references (trunk-based is a design decision). Keep single commit recipe. Source: Oracle interpeer deep review Finding 15.","status":"closed","priority":2,"issue_type":"bug","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-09T07:08:12.737332309-08:00","created_by":"mk","updated_at":"2026-02-09T07:17:37.130855173-08:00","closed_at":"2026-02-09T07:17:37.130855173-08:00","close_reason":"Closed"}
{"id":"Clavain-zuu","title":"Add silent compounding to synthesize.md","description":"Add Post-synthesis section with background Task compounding agent. Reads Findings Index, writes knowledge entries, handles provenance and decay.","status":"closed","priority":1,"issue_type":"task","owner":"mistakeknot@users.noreply.github.com","created_at":"2026-02-10T09:42:22.377020276-08:00","created_by":"mk","updated_at":"2026-02-10T09:59:17.687517118-08:00","closed_at":"2026-02-10T09:59:17.687517118-08:00","close_reason":"Phase 3 complete — all Codex agents succeeded","dependencies":[{"issue_id":"Clavain-zuu","depends_on_id":"Clavain-uid","type":"blocks","created_at":"2026-02-10T09:42:28.67595711-08:00","created_by":"mk"}]}
