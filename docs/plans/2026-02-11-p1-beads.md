# Plan: P1 Beads — Help, Doctor, FD Examples, Pyramid Prep

**Beads:** Clavain-5kea, Clavain-5o97, Clavain-zp9n, Clavain-id6d
**Date:** 2026-02-11

## Task 1: /help command (Clavain-5o97)

Create `commands/help.md` with `disable-model-invocation: true`.

Content structure:
- **Daily drivers first** (8 commands): brainstorm, write-plan, work, quality-gates, flux-drive, resolve, lfg, interpeer
- **By stage** (remaining commands grouped): Explore, Plan, Execute, Review, Ship, Meta
- Each command: name, 1-line description, example invocation
- Footer: "Use `/clavain:using-clavain` for full routing guide"

Update counts: 30→31 commands across CLAUDE.md, plugin.json, AGENTS.md, README.md, test_commands.py, using-clavain/SKILL.md.
Add to using-clavain routing table under Meta stage.

## Task 2: /doctor command (Clavain-zp9n)

Create `commands/doctor.md` with `disable-model-invocation: true`.

Health checks (run in parallel where possible):
1. **MCP servers**: context7 reachable (mcp tool call), qmd responding (mcp tool call)
2. **External tools**: oracle present (`which oracle`), codex present (`which codex`)
3. **Beads**: `.beads/` directory exists and `bd stats` succeeds
4. **Conflicting plugins**: check none of the conflicting plugins from setup.md are enabled
5. **Plugin version**: compare installed vs marketplace version

Output: table of check results with pass/warn/fail status.
Distinct from `/setup` — doctor diagnoses, setup bootstraps.

Update counts: 31→32 commands. Add to routing table under Meta stage.

## Task 3: fd-* example blocks (Clavain-id6d)

Add `<example>` blocks to 6 fd-* agent descriptions, following the plan-reviewer pattern.

Each agent gets 2 examples showing:
- Context: what kind of work is happening
- User message: what triggered the need for this agent
- Assistant response: how to invoke the agent
- Commentary: when/why this agent is the right choice

Agents to update:
- fd-architecture.md — examples: module restructuring, new dependency evaluation
- fd-safety.md — examples: auth flow change, new API endpoint with credentials
- fd-correctness.md — examples: database migration, concurrent queue implementation
- fd-quality.md — examples: Go code review, cross-language refactor
- fd-user-product.md — examples: CLI UX redesign, feature PRD review
- fd-performance.md — examples: slow query investigation, rendering bottleneck

## Task 4: Pyramid scan prep (Clavain-5kea)

Descoped from full pyramid-mode to the triage prep phase only, per flux-drive review findings ("unify ContentSlice with diff slicing BEFORE full implementation").

Add Step 1.2c to `skills/flux-drive/SKILL.md` — between agent selection (1.2) and confirmation (1.3):

**Step 1.2c: Pyramid Scan (large documents only)**
- Trigger: `INPUT_TYPE = file` AND document > 500 lines
- Generate section-level summaries (1-2 sentences per section)
- Map each section to relevant agent domains
- Tag sections as: `full` (agent's core domain), `summary` (adjacent), `skip` (irrelevant)
- Include pyramid summary in agent prompts alongside the full document
- Safety override: sections mentioning auth/credentials/secrets always get `full` tag for fd-safety

This is prep work — agents still receive full content, but the pyramid summary helps them focus. Full content slicing (sending only relevant sections) deferred to Clavain-9tq (P3, flux-drive v2).

## Execution Order

1. Task 3 (fd-* examples) — most mechanical, no dependencies
2. Task 1 (/help) — needs accurate command list
3. Task 2 (/doctor) — independent
4. Task 4 (pyramid prep) — most complex, do last

## Count Impact

- +2 new commands (help, doctor): 30→32
- Run gen-catalog.py after all changes
